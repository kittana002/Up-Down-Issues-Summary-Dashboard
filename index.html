<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>แดชบอร์ดสรุปข้อมูล WireLine & WDS Downtime</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Sarabun:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Sarabun', 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
            background-color: #f3f4f6;
        }
        .dark body {
            background-color: #111827;
        }
        .chart-card {
            height: 400px;
        }
        /* Custom scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 10px; }
        .dark ::-webkit-scrollbar-track { background: #2d3748; }
        ::-webkit-scrollbar-thumb { background: #888; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #555; }

        /* Loading Spinner */
        #loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.3s;
        }
        .dark #loading-overlay {
            background-color: rgba(17, 24, 39, 0.8);
        }
        .spinner {
            width: 56px;
            height: 56px;
            border: 7px solid #4f46e5;
            border-bottom-color: transparent;
            border-radius: 50%;
            display: inline-block;
            box-sizing: border-box;
            animation: rotation 1s linear infinite;
        }
        @keyframes rotation {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Tooltip */
        [data-tooltip] {
            position: relative;
            cursor: pointer;
        }
        [data-tooltip]::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            margin-bottom: 8px;
            background-color: #1f2937;
            color: #ffffff;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 0.875rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s, visibility 0.2s;
            z-index: 10;
        }
        [data-tooltip]:hover::after {
            opacity: 1;
            visibility: visible;
        }
        
        /* Accessibility */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900">

    <div id="loading-overlay">
        <div class="spinner" role="status" aria-label="กำลังโหลดข้อมูล"></div>
    </div>

    <div id="dashboard-container" class="p-4 sm:p-6 lg:p-8 max-w-7xl mx-auto text-gray-700 dark:text-gray-300 opacity-0 transition-opacity duration-500">
        <!-- Header -->
        <header class="mb-8">
            <div class="flex justify-between items-start flex-wrap gap-4">
                <div>
                    <h1 class="text-3xl font-bold text-gray-900 dark:text-gray-100">แดชบอร์ดสรุปข้อมูล Up/Down</h1>
                    <p class="text-gray-500 dark:text-gray-400 mt-1">ภาพรวมสถานะการเชื่อมต่อและประเด็นที่ต้องให้ความสำคัญ</p>
                </div>
                <div class="flex flex-col items-end gap-4">
                     <div id="last-updated" class="text-sm text-right text-gray-500 dark:text-gray-400" aria-live="polite">
                        <!-- Last updated time will be injected here -->
                    </div>
                    <div class="flex items-center gap-3 flex-wrap justify-end">
                        <button id="refresh-btn" class="flex items-center space-x-2 bg-gray-500 hover:bg-gray-600 text-white text-sm font-semibold py-2 px-3 rounded-lg shadow-md transition-colors duration-300">
                            <i data-lucide="refresh-cw" class="w-4 h-4"></i>
                            <span class="sr-only">รีเฟรชข้อมูล</span>
                        </button>
                        <button id="download-all-btn" class="flex items-center space-x-2 bg-purple-500 hover:bg-purple-600 text-white text-sm font-semibold py-2 px-3 rounded-lg shadow-md transition-colors duration-300">
                            <i data-lucide="download" class="w-4 h-4" aria-hidden="true"></i>
                            <span>โหลดข้อมูลทั้งหมด</span>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <main>
            <!-- KPIs -->
            <section id="kpi-container" aria-labelledby="kpi-heading" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <h2 id="kpi-heading" class="sr-only">ตัวชี้วัดประสิทธิภาพหลัก</h2>
                <!-- KPIs will be injected here -->
            </section>

            <!-- Charts Row 1 -->
            <section aria-labelledby="charts-row1-heading" class="grid grid-cols-1 lg:grid-cols-5 gap-6 mb-8">
                <h2 id="charts-row1-heading" class="sr-only">แผนภูมิสรุปผลแถวที่ 1</h2>
                <div class="bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg lg:col-span-2 chart-card flex flex-col">
                    <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4">ประเภท Link ที่มีปัญหา</h3>
                    <div class="relative flex-grow">
                        <canvas id="linkTypeChart"></canvas>
                    </div>
                </div>
                <div class="bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg lg:col-span-3 chart-card flex flex-col">
                    <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4">10 อันดับสาขาที่เกิดปัญหาบ่อยที่สุด</h3>
                    <div id="topIssuesList" class="space-y-3 pr-2 overflow-y-auto flex-grow">
                        <!-- Top issues list will be injected here -->
                    </div>
                </div>
            </section>

            <!-- Charts Row 2 -->
            <section aria-labelledby="charts-row2-heading" class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                 <h2 id="charts-row2-heading" class="sr-only">แผนภูมิสรุปผลแถวที่ 2</h2>
                <div class="bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg chart-card flex flex-col">
                   <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4">จำนวนปัญหาตามภาค</h3>
                   <div class="relative flex-grow">
                       <canvas id="regionChart"></canvas>
                    </div>
                </div>
                 <div class="bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg chart-card flex flex-col">
                   <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4">10 จังหวัดที่เกิดปัญหาบ่อยที่สุด</h3>
                   <div class="relative flex-grow">
                       <canvas id="provinceChart"></canvas>
                    </div>
                </div>
            </section>
            
            <!-- Recent Events -->
            <section aria-labelledby="recent-events-heading" class="bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg mb-8">
                 <h2 id="recent-events-heading" class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4">สรุปเหตุการณ์ Up/Down</h2>
                 <div id="recent-events-container" class="max-h-96 overflow-y-auto">
                     <!-- Recent events accordion will be injected here -->
                 </div>
            </section>

            <!-- Attention Table -->
            <section aria-labelledby="attention-table-heading" class="bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg">
                <div class="flex justify-between items-center mb-4 flex-wrap gap-2">
                    <h2 id="attention-table-heading" class="text-lg font-semibold text-gray-900 dark:text-gray-100">ตารางข้อมูลเหตุการณ์ทั้งหมด</h2>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm text-left text-gray-500 dark:text-gray-400">
                        <thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
                            <tr>
                                <th scope="col" class="px-6 py-3">วันที่</th>
                                <th scope="col" class="px-6 py-3">รอบ</th>
                                <th scope="col" class="px-6 py-3">ประเภท Link</th>
                                <th scope="col" class="px-6 py-3">รหัสร้าน</th>
                                <th scope="col" class="px-6 py-3">ชื่อร้าน</th>
                                <th scope="col" class="px-6 py-3">จังหวัด</th>
                                <th scope="col" class="px-6 py-3">ภาค</th>
                            </tr>
                        </thead>
                        <tbody id="attention-table-body">
                            <!-- Table rows will be injected here -->
                        </tbody>
                    </table>
                </div>
                <div id="pagination-container" class="flex justify-center mt-4">
                    <!-- Pagination controls will be injected here -->
                </div>
            </section>
        </main>
    </div>

    <script type="module">
        // --- Application State and Configuration ---
        const app = {
            state: {
                allEventsData: [],
                charts: {},
                pagination: {
                    currentPage: 1,
                    itemsPerPage: 10,
                }
            },

            // --- Data Fetching and Parsing ---
            async fetchData() {
                const csvData = `วันที่ (Date),รอบ (Period),ประเภท Link (Link Type),รหัสร้าน (Store ID),ชื่อร้าน (Store Name),จังหวัด (Province),ภาค (Region)
24/06/2568,เช้า,Main Link (FTTX),10460,บ้านป่าเป้า,ลำพูน,ภาคเหนือ
24/06/2568,เช้า,Main Link (FTTX),3032,Booth ซอยลูกหลวง,กรุงเทพมหานคร,ภาคกลาง
24/06/2568,เช้า,Main Link (FTTX),10622,LPN ศรีนครินทร์-หัวหมาก,กรุงเทพมหานคร,ภาคกลาง
24/06/2568,เช้า,Main Link (FTTX),10679,รพ.สมิติเวช ศรีนครินทร์,กรุงเทพมหานคร,ภาคกลาง
24/06/2568,เช้า,Main Link (FTTX),13624,หมู่บ้านดีพร้อม(ซอยพุฒสี) (BS),สมุทรปราการ,ภาคกลาง
24/06/2568,เช้า,Backup 4G,13652,โรงพยาบาลมหาราชนครเชียงใหม่ (S เชียงใหม่),เชียงใหม่,ภาคเหนือ
24/06/2568,เช้า,Backup 4G,11208,ปตท.เชียงใหม่-ดอยสะเก็ด,เชียงใหม่,ภาคเหนือ
24/06/2568,เช้า,Backup 4G,3853,อำเภอวังเหนือ,ลำปาง,ภาคเหนือ
24/06/2568,เช้า,Backup 4G,16789,ชุมชนดอนยายหอม (นครปฐม),นครปฐม,ภาคกลาง
24/06/2568,เช้า,Backup 4G,9984,หัวถนน ซ. 11,นครศรีธรรมราช,ภาคใต้
24/06/2568,เช้า,Backup 4G,7550,หนองดินแดง,นครปฐม,ภาคกลาง
24/06/2568,เช้า,Backup 4G,4645,ห้าแยกสันติธรรม 2,เชียงใหม่,ภาคเหนือ
24/06/2568,เช้า,Backup 4G,11063,ดอนตะโก,ราชบุรี,ภาคตะวันตก
24/06/2568,เช้า,Backup 4G,15994,ซอยโรงเหล็ก จุด 2,นครศรีธรรมราช,ภาคใต้
24/06/2568,เช้า,Backup 4G,9742,ชุมตาบง,นครสวรรค์,ภาคกลาง
24/06/2568,บ่าย,Main Link (FTTX),5193,ท่าเรือแหลมเทียน,ตราด,ภาคตะวันออก
24/06/2568,บ่าย,Main Link (FTTX),8537,ชุมชนวัดคูยาง,กำแพงเพชร,ภาคกลาง
24/06/2568,บ่าย,Main Link (FTTX),13078,มศว.ประสานมิตร(ประตู 3) (BS),กรุงเทพมหานคร,ภาคกลาง
24/06/2568,บ่าย,Main Link (FTTX),3032,Booth ซอยลูกหลวง,ชลบุรี,ภาคตะวันออก
24/06/2568,บ่าย,Main Link (FTTX),13150,สุขุมวิท-บ้านอำเภอ (RE),ราชบุรี,ภาคตะวันตก
24/06/2568,บ่าย,Backup 4G,4645,ห้าแยกสันติธรรม 2,สุราษฎร์ธานี,ภาคใต้
24/06/2568,บ่าย,Backup 4G,6837,แยกห้วยไผ่,สุราษฎร์ธานี,ภาคใต้
24/06/2568,บ่าย,Backup 4G,16922,ลีเล็ด (ท่าฉาง),สุพรรณบุรี,ภาคกลาง
24/06/2568,บ่าย,Backup 4G,11208,ปตท.เชียงใหม่-ดอยสะเก็ด,ราชบุรี,ภาคตะวันตก
24/06/2568,บ่าย,Backup 4G,3010,ปตท.ตลาดเมืองใหม่,สุราษฎร์ธานี,ภาคใต้
24/06/2568,บ่าย,Backup 4G,8628,ปตท.ทุ่งคอก,สระบุรี,ภาคกลาง
24/06/2568,บ่าย,Backup 4G,6539,ปตท.จิงโจ้,ราชบุรี,ภาคตะวันตก
24/06/2568,บ่าย,Backup 4G,3126,สามแยกแหลมดิน 1,นครราชสีมา,ภาคตะวันออกเฉียงเหนือ
24/06/2568,บ่าย,Backup 4G,3588,ชุมชนวัดบ้านอ้อย,สมุทรปราการ,ภาคกลาง
24/06/2568,บ่าย,Backup 4G,9628,อำเภอบางแพ,จันทบุรี,ภาคตะวันออก
25/06/2568,เช้า,Main Link (FTTX),10460,บ้านป่าเป้า,ลำพูน,ภาคเหนือ
25/06/2568,เช้า,Main Link (FTTX),18570,โป่งตาลอง(ปากช่อง),กาญจนบุรี,ภาคตะวันตก
25/06/2568,เช้า,Main Link (FTTX),11534,กลางซอยศรีบุญเรือง,ลพบุรี,ภาคกลาง
25/06/2568,เช้า,Main Link (FTTX),14985,PTTOR ทุ่งเบญจา (RE),สระบุรี,ภาคกลาง
25/06/2568,เช้า,Main Link (FTTX),1292,ทรงสวัสดิ์,สมุทรสาคร,ภาคกลาง
25/06/2568,เช้า,Backup 4G,4645,ห้าแยกสันติธรรม 2,สมุทรสาคร,ภาคกลาง
25/06/2568,เช้า,Backup 4G,9742,ชุมตาบง,เชียงราย,ภาคเหนือ
25/06/2568,เช้า,Backup 4G,9628,อำเภอบางแพ,กรุงเทพมหานคร,ภาคกลาง
25/06/2568,เช้า,Backup 4G,2876,ถนนแม่น้ำแคว,กรุงเทพมหานคร,ภาคกลาง
25/06/2568,เช้า,Backup 4G,6402,ลำนารายณ์ 3,สระบุรี,ภาคกลาง
25/06/2568,เช้า,Backup 4G,10652,ปตท.พหลโยธินพระพุทธบาท,อุบลราชธานี,ภาคตะวันออกเฉียงเหนือ
25/06/2568,เช้า,Backup 4G,15994,ซอยโรงเหล็ก จุด 2,สุพรรณบุรี,ภาคกลาง
25/06/2568,เช้า,Backup 4G,7566,โรงพยาบาลเอกชัย,นครปฐม,ภาคกลาง
25/06/2568,เช้า,Backup 4G,300,มหาชัย 2,นครศรีธรรมราช,ภาคใต้
25/06/2568,เช้า,Backup 4G,10587,ตลาดป่ายาง,นครปฐม,ภาคกลาง
25/06/2568,บ่าย,Main Link (FTTX),10460,บ้านป่าเป้า,ลำพูน,ภาคเหนือ
25/06/2568,บ่าย,Main Link (FTTX),13142,บางแวก-สาย2(ซอยกล้วยไม้)BW,ลพบุรี,ภาคกลาง
25/06/2568,บ่าย,Main Link (FTTX),2426,นานาเหนือ (สุขุมวิท 3),สมุทรปราการ,ภาคกลาง
25/06/2568,บ่าย,Main Link (FTTX),15405,ชุมชนเฟื่องฟ้า(ทับกวาง) (NC),ชลบุรี,ภาคตะวันออก
25/06/2568,บ่าย,Main Link (FTTX),16586,ดอนมดแดง,นครปฐม,ภาคกลาง
25/06/2568,บ่าย,Backup 4G,4645,ห้าแยกสันติธรรม 2,พระนครศรีอยุธยา,ภาคกลาง
25/06/2568,บ่าย,Backup 4G,15994,ซอยโรงเหล็ก จุด 2,สุพรรณบุรี,ภาคกลาง
25/06/2568,บ่าย,Backup 4G,16767,ตลาดสวนแตง,ปทุมธานี,ภาคกลาง
25/06/2568,บ่าย,Backup 4G,6539,ปตท.จิงโจ้,สระบุรี,ภาคกลาง
25/06/2568,บ่าย,Backup 4G,2876,ถนนแม่น้ำแคว,กรุงเทพมหานคร,ภาคกลาง
25/06/2568,บ่าย,Backup 4G,9628,อำเภอบางแพ,มุกดาหาร,ภาคตะวันออกเฉียงเหนือ
25/06/2568,บ่าย,Backup 4G,10652,ปตท.พหลโยธินพระพุทธบาท,พิจิตร,ภาคกลาง
25/06/2568,บ่าย,Backup 4G,9271,ลาดปลาเค้า (นครปฐม),เชียงใหม่,ภาคเหนือ
25/06/2568,บ่าย,Backup 4G,11045,พรุฉิมพลี ซอย 1,ชุมพร,ภาคใต้
25/06/2568,บ่าย,Backup 4G,10975,ชุมชนธรรมศาลา,พระนครศรีอยุธยา,ภาคกลาง
26/06/2568,เช้า,Main Link (FTTX),1637,ริเวอร์ปาร์ค,ประจวบคีรีขันธ์,ภาคตะวันตก
26/06/2568,เช้า,Main Link (FTTX),10460,บ้านป่าเป้า,ลำพูน,ภาคเหนือ
26/06/2568,เช้า,Main Link (FTTX),11590,ท่ามะนาว (RN),สมุทรสาคร,ภาคกลาง
26/06/2568,เช้า,Main Link (FTTX),10630,ซอย อบต.เทพารักษ์,เชียงใหม่,ภาคเหนือ
26/06/2568,เช้า,Main Link (FTTX),9075,ตลาดหนองปรือ,ราชบุรี,ภาคตะวันตก
26/06/2568,เช้า,Backup 4G,8056,ดอนขนาก,อุดรธานี,ภาคตะวันออกเฉียงเหนือ
26/06/2568,เช้า,Backup 4G,9628,อำเภอบางแพ,สมุทรปราการ,ภาคกลาง
26/06/2568,เช้า,Backup 4G,9742,ชุมตาบง,อุตรดิตถ์,ภาคเหนือ
26/06/2568,เช้า,Backup 4G,2876,ถนนแม่น้ำแคว,กรุงเทพมหานคร,ภาคกลาง
26/06/2568,เช้า,Backup 4G,4477,ชุมชนวัดคานหาม 4,สมุทรสาคร,ภาคกลาง
26/06/2568,เช้า,Backup 4G,16922,ลีเล็ด (ท่าฉาง),สมุทรสาคร,ภาคกลาง
26/06/2568,เช้า,Backup 4G,10587,ตลาดป่ายาง,อุตรดิตถ์,ภาคเหนือ
26/06/2568,เช้า,Backup 4G,11045,พรุฉิมพลี ซอย 1,ตาก,ภาคตะวันตก
26/06/2568,เช้า,Backup 4G,5502,บางปลาหมอ,ชัยนาท,ภาคกลาง
26/06/2568,เช้า,Backup 4G,3588,ชุมชนวัดบ้านอ้อย,นครศรีธรรมราช,ภาคใต้
26/06/2568,บ่าย,Main Link (FTTX),4926,ม.เรือนสุข 2 คลอง 9,สมุทรสาคร,ภาคกลาง
26/06/2568,บ่าย,Main Link (FTTX),10460,ชุมชนหนองเป็ดน้ำ,นครปฐม,ภาคกลาง
26/06/2568,บ่าย,Main Link (FTTX),18931,ชุมชนตะกุด(สระบุรี) (RC),ลพบุรี,ภาคกลาง
26/06/2568,บ่าย,Main Link (FTTX),13077,อ่อนนุช 66 จุด 2 (BS),น่าน,ภาคเหนือ
26/06/2568,บ่าย,Main Link (FTTX),14998,คำชะอี,เชียงใหม่,ภาคเหนือ
26/06/2568,บ่าย,Backup 4G,11145,วังกรด,สมุทรปราการ,ภาคกลาง
26/06/2568,บ่าย,Backup 4G,9770,FRตลาดเทพมงคล 2,นครสวรรค์,ภาคกลาง
26/06/2568,บ่าย,Backup 4G,13367,ชุมชนบางลึก,พิษณุโลก,ภาคกลาง
26/06/2568,บ่าย,Backup 4G,8134,นรราชอุทิศ,ประจวบคีรีขันธ์,ภาคตะวันตก
26/06/2568,บ่าย,Backup 4G,2365,สามร้อยยอด,ชลบุรี,ภาคตะวันออก
26/06/2568,บ่าย,Backup 4G,6991,นวรัฐ,พัทลุง,ภาคใต้
26/06/2568,บ่าย,Backup 4G,5987,ปตท. LPG พระราม 2 กม. 50,กรุงเทพมหานคร,ภาคกลาง
26/06/2568,บ่าย,Backup 4G,3189,อบต.สุเทพ,ตาก,ภาคตะวันตก
26/06/2568,บ่าย,Backup 4G,954,คฑาธรณ์,พิษณุโลก,ภาคกลาง
26/06/2568,บ่าย,Backup 4G,4173,หมู่บ้านเมืองยิ้ม,ลพบุรี,ภาคกลาง
27/06/2568,เช้า,Main Link (FTTX),10460,บ้านป่าเป้า,ลำพูน,ภาคเหนือ
27/06/2568,เช้า,Main Link (FTTX),1637,ริเวอร์ปาร์ค,พิษณุโลก,ภาคกลาง
27/06/2568,เช้า,Main Link (FTTX),13730,ซอยธรรมศิริ (บางนา กม.25) (BS),กรุงเทพมหานคร,ภาคกลาง
27/06/2568,เช้า,Main Link (FTTX),14496,แยกน้ำอ่าง,กรุงเทพมหานคร,ภาคกลาง
27/06/2568,เช้า,Main Link (FTTX),16047,Hop Inn บางนา,กรุงเทพมหานคร,ภาคกลาง
27/06/2568,เช้า,Backup 4G,6815,ปตท.ท่าไม้,สมุทรปราการ,ภาคกลาง
27/06/2568,เช้า,Backup 4G,16002,PS พฤกษาวิลล์ 99 เพชรเกษม 93(อ้อมน้อย),บึงกาฬ,ภาคตะวันออกเฉียงเหนือ
27/06/2568,เช้า,Backup 4G,16862,PTTOR ลับแล (ฝายหลวง),สระบุรี,ภาคกลาง
27/06/2568,เช้า,Backup 4G,12003,ปตท.แม่ปะ,ราชบุรี,ภาคตะวันตก
27/06/2568,เช้า,Backup 4G,11326,ธรรมามูล,เชียงใหม่,ภาคเหนือ
27/06/2568,เช้า,Backup 4G,16531,ชุมชนปากนคร,สิงห์บุรี,ภาคกลาง
27/06/2568,เช้า,Backup 4G,11155,เลียบคลองบางน้ำจืด,สมุทรสาคร,ภาคกลาง
27/06/2568,เช้า,Backup 4G,17034,ศูนย์การแพทย์กาญจนาภิเษก โซน C,พระนครศรีอยุธยา,ภาคกลาง
27/06/2568,เช้า,Backup 4G,11369,เมืองนารายณ์,น่าน,ภาคเหนือ
27/06/2568,เช้า,Backup 4G,6594,อ.ปัว,เชียงใหม่,ภาคเหนือ
27/06/2568,บ่าย,Main Link (FTTX),16047,Hop Inn บางนา,พระนครศรีอยุธยา,ภาคกลาง
27/06/2568,บ่าย,Main Link (FTTX),2385,อารักษ์ 2,แพร่,ภาคเหนือ
27/06/2568,บ่าย,Main Link (FTTX),10749,สวนปาล์ม,กรุงเทพมหานคร,ภาคกลาง
27/06/2568,บ่าย,Main Link (FTTX),16887,ริมปิงริเวอร์ไซด์(นครสวรรค์),ชัยนาท,ภาคกลาง
27/06/2568,บ่าย,Main Link (FTTX),15264,ทะเลแก้ว (NC),กรุงเทพมหานคร,ภาคกลาง
27/06/2568,บ่าย,Backup 4G,2077,ปตท.ปราณบุรีการค้า,สุราษฎร์ธานี,ภาคใต้
27/06/2568,บ่าย,Backup 4G,4365,ปตท.สุรศักดิ์ออยล์,ราชบุรี,ภาคตะวันตก
27/06/2568,บ่าย,Backup 4G,16253,แยกเขาชัยสน,สุราษฎร์ธานี,ภาคใต้
27/06/2568,บ่าย,Backup 4G,15994,ซอยโรงเหล็ก จุด 2,ราชบุรี,ภาคตะวันตก
27/06/2568,บ่าย,Backup 4G,3400,ปตท.เกษมราษฎร์,สมุทรปราการ,ภาคกลาง
27/06/2568,บ่าย,Backup 4G,16517,นาโบสถ์,นครสวรรค์,ภาคกลาง
27/06/2568,บ่าย,Backup 4G,3030,ม.นเรศวร (ตลาดเมืองทอง ),สมุทรสาคร,ภาคกลาง
27/06/2568,บ่าย,Backup 4G,8148,ปตท.พัฒนานิคม,สระบุรี,ภาคกลาง
27/06/2568,บ่าย,Backup 4G,614,โพธาราม,ชลบุรี,ภาคตะวันออก
27/06/2568,บ่าย,Backup 4G,6213,ถนนบรมไตรโลกนารถ,นครศรีธรรมราช,ภาคใต้
30/06/2568,เช้า,Main Link (FTTX),13959,Belle Park (BW),กรุงเทพมหานคร,ภาคกลาง
30/06/2568,เช้า,Main Link (FTTX),4018,ประดู่ 7,สุพรรณบุรี,ภาคกลาง
30/06/2568,เช้า,Main Link (FTTX),16593,ปรีดีพนมยงค์ 41,พิษณุโลก,ภาคกลาง
30/06/2568,เช้า,Main Link (FTTX),5552,บ้านคลองสวน,สุโขทัย,ภาคกลาง
30/06/2568,เช้า,Main Link (FTTX),6706,เซกา,สมุทรปราการ,ภาคกลาง
30/06/2568,เช้า,Backup 4G,4525,ปตท.หินกอง 2,ภูเก็ต,ภาคใต้
30/06/2568,เช้า,Backup 4G,16002,PS พฤกษาวิลล์ 99 เพชรเกษม 93(อ้อมน้อย),สระแก้ว,ภาคตะวันออก
30/06/2568,เช้า,Backup 4G,8239,ปตท.ดอนทราย (ปากท่อ),นครปฐม,ภาคกลาง
30/06/2568,เช้า,Backup 4G,11708,บ้านทุ่งหมื่นน้อย (อ.สันทราย),เชียงใหม่,ภาคเหนือ
30/06/2568,เช้า,Backup 4G,17124,พรหมมาสตร์,จันทบุรี,ภาคตะวันออก
30/06/2568,เช้า,Backup 4G,851,คลองครุ,นครปฐม,ภาคกลาง
30/06/2568,เช้า,Backup 4G,9716,บางซ้าย,อุดรธานี,ภาคตะวันออกเฉียงเหนือ
30/06/2568,เช้า,Backup 4G,14209,PTTOR สุขุมปัว (NC),กรุงเทพมหานคร,ภาคกลาง
30/06/2568,เช้า,Backup 4G,5147,ตลาดแม่กวง,เชียงใหม่,ภาคเหนือ
30/06/2568,เช้า,Backup 4G,16695,พลัส คอนโด อยุธยาพาร์ค,ลำพูน,ภาคเหนือ
30/06/2568,บ่าย,Main Link (FTTX),10644,ปตท.แยกเวียงทอง,นครปฐม,ภาคกลาง
30/06/2568,บ่าย,Main Link (FTTX),10858,อิสรภาพ 31,ชุมพร,ภาคใต้
30/06/2568,บ่าย,Main Link (FTTX),9992,เทศบาล 4 ชัยนาท,พระนครศรีอยุธยา,ภาคกลาง
30/06/2568,บ่าย,Main Link (FTTX),11145,วังกรด,สมุทรสาคร,ภาคกลาง
30/06/2568,บ่าย,Main Link (FTTX),14085,Silom Terrace,สุโขทัย,ภาคกลาง
30/06/2568,บ่าย,Backup 4G,16922,ลีเล็ด (ท่าฉาง),พระนครศรีอยุธยา,ภาคกลาง
30/06/2568,บ่าย,Backup 4G,13135,สุขเจริญ,พิษณุโลก,ภาคกลาง
30/06/2568,บ่าย,Backup 4G,4835,จอมบึง 2,พิษณุโลก,ภาคกลาง
30/06/2568,บ่าย,Backup 4G,16668,PTTOR ชัยบุรี,นครสวรรค์,ภาคกลาง
30/06/2568,บ่าย,Backup 4G,6815,ปตท.ท่าไม้,กรุงเทพมหานคร,ภาคกลาง
30/06/2568,บ่าย,Backup 4G,8239,ปตท.ดอนทราย (ปากท่อ),กรุงเทพมหานคร,ภาคกลาง
30/06/2568,บ่าย,Backup 4G,17054,PTTOR เขาวัง (ราชบุรี),กรุงเทพมหานคร,ภาคกลาง
30/06/2568,บ่าย,Backup 4G,773,ตลาดอัศวิน,เลย,ภาคตะวันออกเฉียงเหนือ
30/06/2568,บ่าย,Backup 4G,5664,แยกนวมินทร์นครสวรรค์,กำแพงเพชร,ภาคกลาง
30/06/2568,บ่าย,Backup 4G,17012,วัดยกกระบัตร,นครสวรรค์,ภาคกลาง
01/07/2568,บ่าย,Main Link (FTTX),6300,ทับกวาง,นครราชสีมา,ภาคตะวันออกเฉียงเหนือ
01/07/2568,บ่าย,Main Link (FTTX),16081,PTTOR ทุ่งขวาง-พนัส (ทล.349),สมุทรสาคร,ภาคกลาง
01/07/2568,บ่าย,Main Link (FTTX),16740,บ้านไสม่วง,กำแพงเพชร,ภาคกลาง
01/07/2568,บ่าย,Main Link (FTTX),11685,พีรพงษ์ (BW),อุดรธานี,ภาคตะวันออกเฉียงเหนือ
01/07/2568,บ่าย,Main Link (FTTX),13098,ถนนข้าวปลูก (RC),สระบุรี,ภาคกลาง
01/07/2568,บ่าย,Backup 4G,13367,ชุมชนบางลึก,ลพบุรี,ภาคกลาง
01/07/2568,บ่าย,Backup 4G,6636,ท่าทอง,เชียงใหม่,ภาคเหนือ
01/07/2568,บ่าย,Backup 4G,8484,ปตท.คีรีมาศ,สุพรรณบุรี,ภาคกลาง
01/07/2568,บ่าย,Backup 4G,9188,สี่แยกบ่อนไก่ จุด 2,กรุงเทพมหานคร,ภาคกลาง
01/07/2568,บ่าย,Backup 4G,15903,ซอยบางเทา 2,ขอนแก่น,ภาคตะวันออกเฉียงเหนือ
01/07/2568,บ่าย,Backup 4G,16502,รพ.วัฒนานคร ( สระแก้ว ),กรุงเทพมหานคร,ภาคกลาง
01/07/2568,บ่าย,Backup 4G,7085,ชุมชนดอนหวาย,กรุงเทพมหานคร,ภาคกลาง
01/07/2568,บ่าย,Backup 4G,1157,ต้นพยอม,กรุงเทพมหานคร,ภาคกลาง
01/07/2568,บ่าย,Backup 4G,16759,PTTOR หนองอ้อ จันทบุรี,เชียงใหม่,ภาคเหนือ
01/07/2568,บ่าย,Backup 4G,1692,พุทธมณฑลสาย 7,สุพรรณบุรี,ภาคกลาง
02/07/2568,เช้า,Main Link (FTTX),3921,ตลาดโพธิ์สุวรรณ,ตาก,ภาคตะวันตก
02/07/2568,เช้า,Main Link (FTTX),10567,พลมานีย์ จุด 4,สิงห์บุรี,ภาคกลาง
02/07/2568,เช้า,Main Link (FTTX),11351,บ้านสบเปิง (อ.แม่แตง),กาญจนบุรี,ภาคตะวันตก
02/07/2568,เช้า,Main Link (FTTX),5057,คำชะอี,สิงห์บุรี,ภาคกลาง
02/07/2568,เช้า,Main Link (FTTX),5282,บ้านเหมืองง่า,นนทบุรี,ภาคกลาง
02/07/2568,เช้า,Backup 4G,15947,ปากทางโรงเรียนการบินกำแพงแสน,เชียงใหม่,ภาคเหนือ
02/07/2568,เช้า,Backup 4G,12003,ปตท.แม่ปะ,นครปฐม,ภาคกลาง
02/07/2568,เช้า,Backup 4G,15850,ร้านค้าสวัสดิการค่ายเขตอุดมศักดิ์ (SN),นนทบุรี,ภาคกลาง
02/07/2568,เช้า,Backup 4G,7331,ปตท.พหลโยธินวังน้อย กม.78,กรุงเทพมหานคร,ภาคกลาง
02/07/2568,เช้า,Backup 4G,1692,พุทธมณฑลสาย 7,ลพบุรี,ภาคกลาง
02/07/2568,เช้า,Backup 4G,13044,ชุมชนนาดี (BW),ชลบุรี,ภาคตะวันออก
02/07/2568,เช้า,Backup 4G,16634,รพ.สุโขทัย,นครราชสีมา,ภาคตะวันออกเฉียงเหนือ
02/07/2568,เช้า,Backup 4G,1012,ชุมชนวัดพระญาติ,อุดรธานี,ภาคตะวันออกเฉียงเหนือ
02/07/2568,เช้า,Backup 4G,9864,พิษณุโลกพลาซ่า,สมุทรสาคร,ภาคกลาง
02/07/2568,เช้า,Backup 4G,10087,ปตท.เลี่ยงเมืองพิษณุโลก,เชียงใหม่,ภาคเหนือ
02/07/2568,บ่าย,Main Link (FTTX),13886,ปตท.หนองบัว (NC),อ่างทอง,ภาคกลาง
02/07/2568,บ่าย,Main Link (FTTX),12108,พุทธมณฑลสาย 2 ซอย 2 (BW),นครปฐม,ภาคกลาง
02/07/2568,บ่าย,Main Link (FTTX),4312,ซอยนวลจิตร จุด 2,กาญจนบุรี,ภาคตะวันตก
02/07/2568,บ่าย,Main Link (FTTX),4728,นภาจรัส,สงขลา,ภาคใต้
02/07/2568,บ่าย,Main Link (FTTX),14222,PTTOR ด่านซ้าย (NE),นครปฐม,ภาคกลาง
02/07/2568,บ่าย,Backup 4G,11801,ปตท.หนองปลิงกำแพงเพชร (RC),พิษณุโลก,ภาคกลาง
02/07/2568,บ่าย,Backup 4G,3225,ธรรมจักร,ขอนแก่น,ภาคตะวันออกเฉียงเหนือ
02/07/2568,บ่าย,Backup 4G,11833,Cargill Factory Market,กรุงเทพมหานคร,ภาคกลาง
02/07/2568,บ่าย,Backup 4G,10299,DC มหาชัย,กรุงเทพมหานคร,ภาคกลาง
02/07/2568,บ่าย,Backup 4G,10342,ราชดำเนิน (กำแพงเพชร),ชลบุรี,ภาคตะวันออก
02/07/2568,บ่าย,Backup 4G,1230,สันติสุข,ลพบุรี,ภาคกลาง
02/07/2568,บ่าย,Backup 4G,3144,ปตท.หินกอง,พิษณุโลก,ภาคกลาง
02/07/2568,บ่าย,Backup 4G,15621,PTTOR ศูนย์สงครามพิเศษ (RC)(ปตท.100%),เชียงใหม่,ภาคเหนือ
02/07/2568,บ่าย,Backup 4G,5094,FR.บ้านศรีดอนไชย 1,เชียงใหม่,ภาคเหนือ
02/07/2568,บ่าย,Backup 4G,16252,ตลาดรุ่งโรจน์เจริญทรัพย์,เชียงใหม่,ภาคเหนือ
03/07/2568,เช้า,Main Link (FTTX),992,ตลาดสำเหร่,นครปฐม,ภาคกลาง
03/07/2568,เช้า,Main Link (FTTX),15414,ธาราคอนโดเทล 3 (NE),ลำปาง,ภาคเหนือ
03/07/2568,เช้า,Main Link (FTTX),8572,รพ.กรุงเทพ(พลาซ่า),ประจวบคีรีขันธ์,ภาคตะวันตก
03/07/2568,เช้า,Main Link (FTTX),13419,GAYSORN OFFICE TOWER (BW),นครศรีธรรมราช,ภาคใต้
03/07/2568,เช้า,Main Link (FTTX),338,ตลาดพลู,เชียงใหม่,ภาคเหนือ
03/07/2568,เช้า,Backup 4G,5840,ปตท.น้ำแพร่,นครราชสีมา,ภาคตะวันออกเฉียงเหนือ
03/07/2568,เช้า,Backup 4G,17054,PTTOR เขาวัง (ราชบุรี),กรุงเทพมหานคร,ภาคกลาง
03/07/2568,เช้า,Backup 4G,16016,ศรีประจันต์,หนองคาย,ภาคตะวันออกเฉียงเหนือ
03/07/2568,เช้า,Backup 4G,5000,ตากพิทยาคม,เชียงใหม่,ภาคเหนือ
03/07/2568,เช้า,Backup 4G,5583,ตลาดปลาชมภูพงศ์,กรุงเทพมหานคร,ภาคกลาง
03/07/2568,เช้า,Backup 4G,7695,ไปรษณีย์กาญจน์,เพชรบุรี,ภาคตะวันตก
03/07/2568,เช้า,Backup 4G,2159,บขส.สิงห์บุรี,สิงห์บุรี,ภาคกลาง
03/07/2568,เช้า,Backup 4G,6927,ซอยประทานพร,นครนายก,ภาคกลาง
03/07/2568,เช้า,Backup 4G,9307,บ้านหนองโค้ง,ชลบุรี,ภาคตะวันออก
03/07/2568,เช้า,Backup 4G,4172,ปตท.นครชัยศรี,ราชบุรี,ภาคตะวันตก
03/07/2568,บ่าย,Main Link (FTTX),6186,ม.พฤกษาวิลล์ 63-พระราม 5,เชียงราย,ภาคเหนือ
03/07/2568,บ่าย,Main Link (FTTX),8145,อาคารสมเด็จพระเทพรัตน์(ร.พ.รามาฯ),สมุทรสงคราม,ภาคกลาง
03/07/2568,บ่าย,Main Link (FTTX),13428,พัฒนานิคมสาย 4 (เขาสูง) (RC),ระยอง,ภาคตะวันออก
03/07/2568,บ่าย,Main Link (FTTX),16045,PTTOR แยกบ้านบึง,พระนครศรีอยุธยา,ภาคกลาง
03/07/2568,บ่าย,Main Link (FTTX),17058,ขนงพระใต้,กำแพงเพชร,ภาคกลาง
03/07/2568,บ่าย,Backup 4G,8358,หลังอุดรทิพย์,เชียงใหม่,ภาคเหนือ
03/07/2568,บ่าย,Backup 4G,11174,ท่าไม้,ปราจีนบุรี,ภาคตะวันออก
03/07/2568,บ่าย,Backup 4G,3804,ปตทหนองผึ้ง,กรุงเทพมหานคร,ภาคกลาง
03/07/2568,บ่าย,Backup 4G,16267,องครักษ์ อ่างทอง,กรุงเทพมหานคร,ภาคกลาง
03/07/2568,บ่าย,Backup 4G,16765,ชุมชนบ้านเจริญสุข(กำแพงแสน),ชลบุรี,ภาคตะวันออก
03/07/2568,บ่าย,Backup 4G,544,ริเวอร์แคว,สระบุรี,ภาคกลาง
03/07/2568,บ่าย,Backup 4G,16774,PTTOR เขาเขียว (สิงหนคร),ลพบุรี,ภาคกลาง
03/07/2568,บ่าย,Backup 4G,16650,เปโตร-ดงเกตุ,สิงห์บุรี,ภาคกลาง
03/07/2568,บ่าย,Backup 4G,17034,ศูนย์การแพทย์กาญจนาภิเษก โซน C,สุพรรณบุรี,ภาคกลาง
03/07/2568,บ่าย,Backup 4G,5072,พระองค์ดำ(พิษณุโลก),พิษณุโลก,ภาคกลาง
04/07/2568,เช้า,Main Link (FTTX),4673,อดุลยาราม,แม่ฮ่องสอน,ภาคเหนือ
04/07/2568,เช้า,Main Link (FTTX),11107,สุขุมวิท 66 (BS),สุราษฎร์ธานี,ภาคใต้
04/07/2568,เช้า,Main Link (FTTX),11942,SV พระราม 3,สิงห์บุรี,ภาคกลาง
04/07/2568,เช้า,Main Link (FTTX),11470,คลองตำหรุ 5 (ชลบุรี),สมุทรสาคร,ภาคกลาง
04/07/2568,เช้า,Main Link (FTTX),3648,ซอยบาดาล,ราชบุรี,ภาคตะวันตก
04/07/2568,เช้า,Backup 4G,5566,ปทุมทอง 2,กรุงเทพมหานคร,ภาคกลาง
04/07/2568,เช้า,Backup 4G,8629,หน้าโรงพยาบาลมหาราช (เชียงใหม่),เชียงใหม่,ภาคเหนือ
04/07/2568,เช้า,Backup 4G,11399,แยกสนามบิน2,นนทบุรี,ภาคกลาง
04/07/2568,เช้า,Backup 4G,13952,FR.โรงพยาบาลราชเวช,เชียงใหม่,ภาคเหนือ
04/07/2568,เช้า,Backup 4G,16751,สามพราน ซอย 2,ระนอง,ภาคใต้
04/07/2568,เช้า,Backup 4G,9528,แม่ทะ,ภูเก็ต,ภาคใต้
04/07/2568,เช้า,Backup 4G,7016,ปตท.บางสะพาน,พังงา,ภาคใต้
04/07/2568,เช้า,Backup 4G,2838,ชุมชนท่าศาลา,สงขลา,ภาคใต้
04/07/2568,เช้า,Backup 4G,8083,หน้าโรงพยาบาลสารภี,สุราษฎร์ธานี,ภาคใต้
04/07/2568,เช้า,Backup 4G,11954,ตลาดคลังมาร์เช่,ระยอง,ภาคตะวันออก
04/07/2568,บ่าย,Main Link (FTTX),4674,เจริญกรุง 70,เพชรบูรณ์,ภาคกลาง
04/07/2568,บ่าย,Main Link (FTTX),14000,ไนท์หนองคาย (NE),สงขลา,ภาคใต้
04/07/2568,บ่าย,Main Link (FTTX),7349,ถนนสามล้าน,สุราษฎร์ธานี,ภาคใต้
04/07/2568,บ่าย,Main Link (FTTX),11966,RSU Tower,เชียงราย,ภาคเหนือ
04/07/2568,บ่าย,Main Link (FTTX),14133,ชายหาดหนองแจง(ชะอำใต้) (SN),เชียงใหม่,ภาคเหนือ
04/07/2568,บ่าย,Backup 4G,8629,หน้าโรงพยาบาลมหาราช (เชียงใหม่),กรุงเทพมหานคร,ภาคกลาง
04/07/2568,บ่าย,Backup 4G,11352,อัมพวัน (สิงห์บุรี),ปราจีนบุรี,ภาคตะวันออก
04/07/2568,บ่าย,Backup 4G,3928,ปตท.นครนายก,ขอนแก่น,ภาคตะวันออกเฉียงเหนือ
04/07/2568,บ่าย,Backup 4G,6888,ปตท.ฟ้าใส,ร้อยเอ็ด,ภาคตะวันออกเฉียงเหนือ
04/07/2568,บ่าย,Backup 4G,6884,ปตท.ดอนตะโก,พิษณุโลก,ภาคกลาง
04/07/2568,บ่าย,Backup 4G,7143,แม่สาย 4,นครราชสีมา,ภาคตะวันออกเฉียงเหนือ
04/07/2568,บ่าย,Backup 4G,11859,บางน้อยใน,ตาก,ภาคตะวันตก
04/07/2568,บ่าย,Backup 4G,6237,ห้วยโป่ง ซอย12,สุรินทร์,ภาคตะวันออกเฉียงเหนือ
04/07/2568,บ่าย,Backup 4G,2156,ประตูชัย (อยุธยา),เพชรบุรี,ภาคตะวันตก
04/07/2568,บ่าย,Backup 4G,8246,ปตท.ทรงธรรม,สมุทรสาคร,ภาคกลาง
07/07/2568,เช้า,Main Link (FTTX),4211,ปตท.แม่ริม,สมุทรสาคร,ภาคกลาง
07/07/2568,เช้า,Main Link (FTTX),1403,โรงพยาบาลเจ้าพระยาอภัยภูเบศร์,เชียงใหม่,ภาคเหนือ
07/07/2568,เช้า,Main Link (FTTX),4157,บางปอซอย 4,กรุงเทพมหานคร,ภาคกลาง
07/07/2568,เช้า,Main Link (FTTX),5372,พุทธมณฑลสาย 1 ซอย 4,ลพบุรี,ภาคกลาง
07/07/2568,เช้า,Main Link (FTTX),6485,พรประภานิมิตร ซอย 22,กรุงเทพมหานคร,ภาคกลาง
07/07/2568,เช้า,Backup 4G,15820,มวกเหล็ก-เขาใหญ่,ระยอง,ภาคตะวันออก
07/07/2568,เช้า,Backup 4G,11039,แยกนารายณ์ฮิลล์,กรุงเทพมหานคร,ภาคกลาง
07/07/2568,เช้า,Backup 4G,11765,บางงา (RC),นครปฐม,ภาคกลาง
07/07/2568,เช้า,Backup 4G,5123,หน้า รพ.เดิมบางนางบวช,ภูเก็ต,ภาคใต้
07/07/2568,เช้า,Backup 4G,1845,จ่านกร้อง,เพชรบุรี,ภาคตะวันตก
07/07/2568,เช้า,Backup 4G,10443,ปตท.สุขุมแม่สะเรียง,นครนายก,ภาคกลาง
07/07/2568,เช้า,Backup 4G,3599,ปตท.ธรรมบูชา,เพชรบุรี,ภาคตะวันตก
07/07/2568,เช้า,Backup 4G,16144,รพ.อินทร์บุรี,ภูเก็ต,ภาคใต้
07/07/2568,เช้า,Backup 4G,11694,ปตท.ถนนเศรษฐกิจ กม.16,เชียงราย,ภาคเหนือ
07/07/2568,เช้า,Backup 4G,7683,ปตท.หลักเมืองมั่นคง,สมุทรสาคร,ภาคกลาง
07/07/2568,บ่าย,Main Link (FTTX),94,จรัญสนิทวงศ์ 37,กรุงเทพมหานคร,ภาคกลาง
07/07/2568,บ่าย,Main Link (FTTX),10492,ปตท.ไชยปราการ,สมุทรปราการ,ภาคกลาง
07/07/2568,บ่าย,Main Link (FTTX),13141,LPN วิลล์ นครอินทร์-ริเวอร์วิว,เพชรบุรี,ภาคตะวันตก
07/07/2568,บ่าย,Main Link (FTTX),2512,ราม 51/2,กรุงเทพมหานคร,ภาคกลาง
07/07/2568,บ่าย,Main Link (FTTX),11504,บ้านในวก (RS),ชลบุรี,ภาคตะวันออก
07/07/2568,บ่าย,Backup 4G,6857,ถนนประชาอุทิศภูเก็ต,สุพรรณบุรี,ภาคกลาง
07/07/2568,บ่าย,Backup 4G,16597,รพ.ตะกั่วป่า,หนองคาย,ภาคตะวันออกเฉียงเหนือ
07/07/2568,บ่าย,Backup 4G,16970,ตำบลคูหาใต้,กรุงเทพมหานคร,ภาคกลาง
07/07/2568,บ่าย,Backup 4G,8562,ตลาดหน้าศูนย์สุราษฎร์,เชียงใหม่,ภาคเหนือ
07/07/2568,บ่าย,Backup 4G,6349,หาดพลา,สมุทรสงคราม,ภาคกลาง
07/07/2568,บ่าย,Backup 4G,16817,นาชุม,ลำปาง,ภาคเหนือ
07/07/2568,บ่าย,Backup 4G,5231,กาญจนวนิช ซอย11,พิษณุโลก,ภาคกลาง
07/07/2568,บ่าย,Backup 4G,9111,เอกทวีคูณ,เชียงใหม่,ภาคเหนือ
07/07/2568,บ่าย,Backup 4G,16987,ถนนสนามบินเก่า,เชียงใหม่,ภาคเหนือ
07/07/2568,บ่าย,Backup 4G,11656,บ้านเชิงดอย (ถ.สุเทพ),สมุทรสาคร,ภาคกลาง
08/07/2568,เช้า,Main Link (FTTX),13652,โรงพยาบาลมหาราชนครเชียงใหม่ (S เชียงใหม่),สมุทรสงคราม,ภาคกลาง
08/07/2568,เช้า,Main Link (FTTX),9214,ม.จรัญวิลล่า 1,เชียงใหม่,ภาคเหนือ
08/07/2568,เช้า,Main Link (FTTX),14272,บ้านโป่งไผ่ (ศรีมหาโพธิ์) (RE),เชียงใหม่,ภาคเหนือ
08/07/2568,เช้า,Main Link (FTTX),8341,ศิริสุข 1,ขอนแก่น,ภาคตะวันออกเฉียงเหนือ
08/07/2568,เช้า,Main Link (FTTX),3028,ปตท.ปัทมานนท์,ร้อยเอ็ด,ภาคตะวันออกเฉียงเหนือ
08/07/2568,เช้า,Backup 4G,15693,ชุมชนเต็งหนาม (RN),พิษณุโลก,ภาคกลาง
08/07/2568,เช้า,Backup 4G,8523,ปตท.สระบุรี-ห้วยบง,นครราชสีมา,ภาคตะวันออกเฉียงเหนือ
08/07/2568,เช้า,Backup 4G,16409,เมืองตาก,ตาก,ภาคตะวันตก
08/07/2568,เช้า,Backup 4G,15711,PTTOR บ้านพลวงปราสาท,สุรินทร์,ภาคตะวันออกเฉียงเหนือ
08/07/2568,เช้า,Backup 4G,6584,ตลาดวังหม้อแกง,เพชรบุรี,ภาคตะวันตก
08/07/2568,เช้า,Backup 4G,7469,บางน้ำจืด,สมุทรสาคร,ภาคกลาง
08/07/2568,เช้า,Backup 4G,16254,พระราม 2 กม. 34 (มหาชัย),สมุทรสาคร,ภาคกลาง
08/07/2568,เช้า,Backup 4G,11066,แม่ริม4(บ้านท้องฝาย),เชียงใหม่,ภาคเหนือ
08/07/2568,เช้า,Backup 4G,11102,พีเรสซิเด้นซ์,กรุงเทพมหานคร,ภาคกลาง
08/07/2568,เช้า,Backup 4G,11319,ตลาดเอราวัณ (ลพบุรี),ลพบุรี,ภาคกลาง
08/07/2568,บ่าย,Main Link (FTTX),6767,ตลาดกระทิงแดง,กรุงเทพมหานคร,ภาคกลาง
08/07/2568,บ่าย,Main Link (FTTX),9365,ปตท.ตลาดตะพง (ระยอง),ระยอง,ภาคตะวันออก
08/07/2568,บ่าย,Main Link (FTTX),4211,ปตท.แม่ริม,เชียงใหม่,ภาคเหนือ
08/07/2568,บ่าย,Main Link (FTTX),10025,LPN อ่อนนุช 46,กรุงเทพมหานคร,ภาคกลาง
08/07/2568,บ่าย,Main Link (FTTX),13040,สบาย ศาลายา (BW),นครปฐม,ภาคกลาง
08/07/2568,บ่าย,Backup 4G,4822,ชุมชนเกาะสิเหร่,ภูเก็ต,ภาคใต้
08/07/2568,บ่าย,Backup 4G,2820,Booth อาชีวะเพชรบุรี,เพชรบุรี,ภาคตะวันตก
08/07/2568,บ่าย,Backup 4G,10486,ปตท.คลอง29 นครนายก,นครนายก,ภาคกลาง
08/07/2568,บ่าย,Backup 4G,3467,โรงเรียนเบญจมะ ( เพชรบุรี ),เพชรบุรี,ภาคตะวันตก
08/07/2568,บ่าย,Backup 4G,9641,หมู่บ้านฉลองสุข,ภูเก็ต,ภาคใต้
08/07/2568,บ่าย,Backup 4G,9722,สันป่าก๊อ,เชียงราย,ภาคเหนือ
08/07/2568,บ่าย,Backup 4G,7608,ปตท.สหกรณ์การเกษตรกระทุ่มแบน,สมุทรสาคร,ภาคกลาง
08/07/2568,บ่าย,Backup 4G,8112,สาย 2 อเวนิว,กรุงเทพมหานคร,ภาคกลาง
08/07/2568,บ่าย,Backup 4G,3677,หมู่บ้านเปรมฤทัยเลคพาร์ค,สมุทรปราการ,ภาคกลาง
08/07/2568,บ่าย,Backup 4G,16718,หนองแจง,เพชรบุรี,ภาคตะวันตก
09/07/2568,เช้า,Main Link (FTTX),3835,อ่อนนุช 46,กรุงเทพมหานคร,ภาคกลาง
09/07/2568,เช้า,Main Link (FTTX),4685,ปตท. หนองไผ่แก้ว,ชลบุรี,ภาคตะวันออก
09/07/2568,เช้า,Main Link (FTTX),6075,ปตท.บางปลาม้า(สุพรรณบุรี),สุพรรณบุรี,ภาคกลาง
09/07/2568,เช้า,Main Link (FTTX),8923,ปตท.จอมเสด็จหนองคาย,หนองคาย,ภาคตะวันออกเฉียงเหนือ
09/07/2568,เช้า,Main Link (FTTX),14483,จรัญฯ 75 แยก 3,กรุงเทพมหานคร,ภาคกลาง
09/07/2568,เช้า,Backup 4G,5165,ลอยเคราะห์ 3,เชียงใหม่,ภาคเหนือ
09/07/2568,เช้า,Backup 4G,10573,ปตท.แม่กลอง-อัมพวา,สมุทรสงคราม,ภาคกลาง
09/07/2568,เช้า,Backup 4G,16408,ชุมชนปันง้าว,ลำปาง,ภาคเหนือ
09/07/2568,เช้า,Backup 4G,4656,ปตท.สิงหวัฒน์,พิษณุโลก,ภาคกลาง
09/07/2568,เช้า,Backup 4G,11084,ปตท.แยกสันกลาง,เชียงใหม่,ภาคเหนือ
09/07/2568,เช้า,Backup 4G,13278,ปตท.สุขุมแม่ริม (RN),เชียงใหม่,ภาคเหนือ
09/07/2568,เช้า,Backup 4G,5749,อ่างน้ำบ้านแพ้ว,สมุทรสาคร,ภาคกลาง
09/07/2568,เช้า,Backup 4G,10119,ปตท.บ้านปรก(สมุทรสงคราม),สมุทรสงคราม,ภาคกลาง
09/07/2568,เช้า,Backup 4G,14155,หมื่นด้ามพร้าคต 2,เชียงใหม่,ภาคเหนือ
09/07/2568,เช้า,Backup 4G,1749,สันกำแพง,เชียงใหม่,ภาคเหนือ
`;
                try {
                    const lines = csvData.trim().split('\n');
                    const headers = lines[0].split(',').map(h => h.trim());
                    const data = lines.slice(1).map(line => {
                        const values = line.split(',');
                        let obj = {};
                        headers.forEach((header, index) => {
                            obj[header] = values[index] ? values[index].trim() : '';
                        });
                        return obj;
                    });
                    this.state.allEventsData = data;
                } catch (error) {
                    console.error("Failed to parse CSV data:", error);
                    alert("ไม่สามารถแปลงข้อมูล CSV ได้");
                    this.state.allEventsData = [];
                }
            },

            // --- Data Processing ---
            processData() {
                const data = this.state.allEventsData;

                const linkTypeCounts = data.reduce((acc, d) => {
                    const type = d['ประเภท Link (Link Type)'];
                    if (type) acc[type] = (acc[type] || 0) + 1;
                    return acc;
                }, {});

                const storeIssueCounts = data.reduce((acc, d) => {
                    const storeId = d['รหัสร้าน (Store ID)'];
                    const storeName = d['ชื่อร้าน (Store Name)'];
                    if (storeId) {
                        if (!acc[storeId]) {
                            acc[storeId] = { name: storeName, count: 0 };
                        }
                        acc[storeId].count++;
                    }
                    return acc;
                }, {});
                
                const topStoreIssues = Object.entries(storeIssueCounts)
                    .map(([id, data]) => ({ id, name: data.name, count: data.count }))
                    .sort((a, b) => b.count - a.count)
                    .slice(0, 10);

                const regionCounts = data.reduce((acc, d) => {
                    const region = d['ภาค (Region)'];
                    if (region) acc[region] = (acc[region] || 0) + 1;
                    return acc;
                }, {});

                const provinceCounts = data.reduce((acc, d) => {
                    const province = d['จังหวัด (Province)'];
                    if (province) acc[province] = (acc[province] || 0) + 1;
                    return acc;
                }, {});
                const topProvinces = Object.entries(provinceCounts).map(([name, value]) => ({ name, value })).sort((a, b) => b.value - a.value).slice(0, 10);

                const eventsByDate = data.reduce((acc, d) => {
                    const date = d['วันที่ (Date)'];
                    if (!date) return acc;
                    if (!acc[date]) {
                        acc[date] = { main: [], backup: [] };
                    }
                    const eventDetail = { id: d['รหัสร้าน (Store ID)'], name: d['ชื่อร้าน (Store Name)'] };
                    if (d['ประเภท Link (Link Type)'].includes('Main')) {
                        acc[date].main.push(eventDetail);
                    } else {
                        acc[date].backup.push(eventDetail);
                    }
                    return acc;
                }, {});
                
                const recentEvents = Object.entries(eventsByDate).map(([date, data]) => ({ date, ...data })).sort((a,b) => new Date(b.date) - new Date(a.date));

                return {
                    totalIssues: data.length,
                    linkTypeCounts,
                    topStoreIssues,
                    regionCounts,
                    topProvinces,
                    recentEvents
                };
            },

            // --- Rendering Functions ---
            render() {
                const data = this.processData();
                this.renderKPIs(data);
                this.renderCharts(data);
                this.renderTopIssuesList(data);
                this.renderRecentEvents(data);
                this.renderAttentionTable();
                lucide.createIcons();
            },

            renderKPIs(data) {
                const container = document.getElementById('kpi-container');
                const regionCounts = data.regionCounts;
                const mostProblematicRegion = Object.keys(regionCounts).length > 0 ? Object.keys(regionCounts).reduce((a, b) => regionCounts[a] > regionCounts[b] ? a : b, 'N/A') : 'N/A';
                
                container.innerHTML = `
                    <div class="bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg" data-tooltip="จำนวนเหตุการณ์ Up/Down ทั้งหมดที่บันทึก">
                        <div class="flex items-center"><div class="p-3 rounded-xl mr-4 bg-red-500"><i data-lucide="alert-circle" class="h-6 w-6 text-white"></i></div><div><p class="text-sm text-gray-500 dark:text-gray-400 font-medium">รวมทุกเหตุการณ์</p><p class="text-2xl font-bold text-gray-800 dark:text-gray-100">${data.totalIssues}</p></div></div>
                    </div>
                    <div class="bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg" data-tooltip="จำนวนปัญหาที่เกิดกับ Main Link">
                        <div class="flex items-center"><div class="p-3 rounded-xl mr-4 bg-blue-500"><i data-lucide="arrow-up-circle" class="h-6 w-6 text-white"></i></div><div><p class="text-sm text-gray-500 dark:text-gray-400 font-medium">ปัญหา Main Link</p><p class="text-2xl font-bold text-gray-800 dark:text-gray-100">${data.linkTypeCounts['Main Link (FTTX)'] || 0}</p></div></div>
                    </div>
                     <div class="bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg" data-tooltip="จำนวนปัญหาที่เกิดกับ Backup 4G">
                        <div class="flex items-center"><div class="p-3 rounded-xl mr-4 bg-yellow-500"><i data-lucide="arrow-down-circle" class="h-6 w-6 text-white"></i></div><div><p class="text-sm text-gray-500 dark:text-gray-400 font-medium">ปัญหา Backup 4G</p><p class="text-2xl font-bold text-gray-800 dark:text-gray-100">${data.linkTypeCounts['Backup 4G'] || 0}</p></div></div>
                    </div>
                    <div class="bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg" data-tooltip="ภาคที่พบปัญหาบ่อยที่สุด">
                        <div class="flex items-center"><div class="p-3 rounded-xl mr-4 bg-orange-500"><i data-lucide="globe" class="h-6 w-6 text-white"></i></div><div><p class="text-sm text-gray-500 dark:text-gray-400 font-medium">ภาคที่เกิดปัญหาบ่อยสุด</p><p class="text-2xl font-bold text-gray-800 dark:text-gray-100">${mostProblematicRegion}</p></div></div>
                    </div>
                `;
            },

            renderCharts(data) {
                const BAR_COLORS = ['#60A5FA', '#A78BFA', '#F472B6', '#FBBF24', '#34D399', '#FB923C', '#4ADE80', '#2DD4BF', '#818CF8', '#E879F9'];
                const PIE_COLORS = { 'Main Link (FTTX)': '#3B82F6', 'Backup 4G': '#F59E0B' };
                const isDarkMode = document.documentElement.classList.contains('dark') || document.body.classList.contains('dark');
                const textColor = isDarkMode ? 'rgba(236, 239, 241, 0.9)' : 'rgba(55, 65, 81, 1)';
                const gridColor = isDarkMode ? 'rgba(255, 255, 255, 0.15)' : 'rgba(0, 0, 0, 0.1)';
                
                Chart.defaults.color = textColor;

                Object.values(this.state.charts).forEach(chart => chart.destroy());

                const sharedChartOptions = {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { labels: { color: textColor } },
                        title: { color: textColor }
                    },
                    scales: {
                        y: { ticks: { color: textColor }, grid: { color: gridColor }, title: { color: textColor, display: false } },
                        x: { ticks: { color: textColor }, grid: { color: gridColor }, title: { color: textColor, display: false } }
                    }
                };

                this.state.charts.linkTypeChart = new Chart(document.getElementById('linkTypeChart'), {
                    type: 'pie',
                    data: {
                        labels: Object.keys(data.linkTypeCounts),
                        datasets: [{ data: Object.values(data.linkTypeCounts), backgroundColor: Object.keys(data.linkTypeCounts).map(k => PIE_COLORS[k]), borderColor: isDarkMode ? '#111827' : '#ffffff', borderWidth: 2 }]
                    },
                    options: { ...sharedChartOptions, plugins: { ...sharedChartOptions.plugins, legend: { ...sharedChartOptions.plugins.legend, position: 'bottom' } } }
                });
                
                this.state.charts.regionChart = new Chart(document.getElementById('regionChart'), {
                    type: 'bar',
                    data: {
                        labels: Object.keys(data.regionCounts),
                        datasets: [{ label: 'จำนวนครั้ง', data: Object.values(data.regionCounts), backgroundColor: BAR_COLORS }]
                    },
                    options: { ...sharedChartOptions, plugins: { ...sharedChartOptions.plugins, legend: { display: false } } }
                });

                this.state.charts.provinceChart = new Chart(document.getElementById('provinceChart'), {
                    type: 'bar',
                    data: {
                        labels: data.topProvinces.map(p => p.name),
                        datasets: [{ label: 'จำนวนครั้ง', data: data.topProvinces.map(p => p.value), backgroundColor: BAR_COLORS.slice().reverse() }]
                    },
                    options: { 
                        ...sharedChartOptions,
                        indexAxis: 'y', 
                        plugins: { ...sharedChartOptions.plugins, legend: { display: false } },
                        scales: { ...sharedChartOptions.scales, y: { ...sharedChartOptions.scales.y, ticks: { ...sharedChartOptions.scales.y.ticks, font: { size: 10 } } } }
                    }
                });
            },

            renderTopIssuesList(data) {
                const container = document.getElementById('topIssuesList');
                if (data.topStoreIssues.length === 0) {
                    container.innerHTML = '<p class="text-center text-gray-500 dark:text-gray-400">ไม่มีข้อมูล</p>';
                    return;
                }
                const maxCount = Math.max(...data.topStoreIssues.map(d => d.count));
                container.innerHTML = data.topStoreIssues.map(item => `
                    <div class="bg-gray-100 dark:bg-gray-700/50 p-3 rounded-lg">
                        <div class="flex justify-between items-center mb-2 gap-2 flex-wrap">
                            <p class="font-bold text-sm text-gray-800 dark:text-white truncate pr-2 flex-1 min-w-0">${item.name} (${item.id})</p>
                            <p class="text-sm font-semibold text-red-500 dark:text-red-400 whitespace-nowrap flex-shrink-0">${item.count} ครั้ง</p>
                        </div>
                        <div class="w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2.5" aria-label="แถบแสดงจำนวนปัญหา">
                            <div class="bg-red-500 h-2.5 rounded-full" style="width: ${maxCount > 0 ? (item.count / maxCount) * 100 : 0}%"></div>
                        </div>
                    </div>
                `).join('');
            },
            
            renderAttentionTable() {
                const tableBody = document.getElementById('attention-table-body');
                const { currentPage, itemsPerPage } = this.state.pagination;
                const data = this.state.allEventsData;

                if (data.length === 0) {
                    tableBody.innerHTML = `<tr><td colspan="7" class="text-center py-8 text-gray-500 dark:text-gray-400">ไม่พบข้อมูล</td></tr>`;
                    return;
                }

                const startIndex = (currentPage - 1) * itemsPerPage;
                const endIndex = startIndex + itemsPerPage;
                const paginatedData = data.slice(startIndex, endIndex);

                tableBody.innerHTML = paginatedData.map(item => `
                    <tr class="bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600">
                        <td class="px-6 py-4">${item['วันที่ (Date)'] || 'N/A'}</td>
                        <td class="px-6 py-4">${item['รอบ (Period)'] || 'N/A'}</td>
                        <td class="px-6 py-4">${item['ประเภท Link (Link Type)'] || 'N/A'}</td>
                        <td class="px-6 py-4">${item['รหัสร้าน (Store ID)'] || 'N/A'}</td>
                        <td class="px-6 py-4 font-medium text-gray-900 dark:text-white whitespace-nowrap">${item['ชื่อร้าน (Store Name)'] || 'N/A'}</td>
                        <td class="px-6 py-4">${item['จังหวัด (Province)'] || 'N/A'}</td>
                        <td class="px-6 py-4">${item['ภาค (Region)'] || 'N/A'}</td>
                    </tr>
                `).join('');
                
                this.renderPaginationControls();
            },

            renderPaginationControls() {
                const { currentPage, itemsPerPage } = this.state.pagination;
                const totalItems = this.state.allEventsData.length;
                const totalPages = Math.ceil(totalItems / itemsPerPage);
                const container = document.getElementById('pagination-container');

                if (totalPages <= 1) {
                    container.innerHTML = '';
                    return;
                }

                let paginationHTML = '<nav aria-label="Pagination"><ul class="flex items-center -space-x-px h-8 text-sm">';
                
                paginationHTML += `<li><button id="prev-page" class="flex items-center justify-center px-3 h-8 ms-0 leading-tight text-gray-500 bg-white border border-e-0 border-gray-300 rounded-s-lg hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white" ${currentPage === 1 ? 'disabled' : ''}>ก่อนหน้า</button></li>`;

                const pagesPerBlock = 5;
                const currentBlock = Math.ceil(currentPage / pagesPerBlock);
                const startPage = (currentBlock - 1) * pagesPerBlock + 1;
                const endPage = Math.min(startPage + pagesPerBlock - 1, totalPages);

                for (let i = startPage; i <= endPage; i++) {
                    const activeClasses = 'z-10 flex items-center justify-center px-3 h-8 leading-tight text-blue-600 border border-blue-300 bg-blue-50 hover:bg-blue-100 hover:text-blue-700 dark:border-gray-700 dark:bg-gray-700 dark:text-white';
                    const defaultClasses = 'flex items-center justify-center px-3 h-8 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white';
                    paginationHTML += `<li><button data-page="${i}" class="${currentPage === i ? activeClasses : defaultClasses}">${i}</button></li>`;
                }

                paginationHTML += `<li><button id="next-page" class="flex items-center justify-center px-3 h-8 leading-tight text-gray-500 bg-white border border-gray-300 rounded-e-lg hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white" ${currentPage === totalPages ? 'disabled' : ''}>ถัดไป</button></li>`;

                paginationHTML += '</ul></nav>';
                container.innerHTML = paginationHTML;
            },

            renderRecentEvents(data) {
                const container = document.getElementById('recent-events-container');
                 if (data.recentEvents.length === 0) {
                    container.innerHTML = '<p class="text-center text-gray-500 dark:text-gray-400">ไม่มีข้อมูลเหตุการณ์ล่าสุด</p>';
                    return;
                }
                container.innerHTML = data.recentEvents.map((event, idx) => `
                    <div class="border-b border-gray-200 dark:border-gray-700">
                        <details class="group" ${idx < 3 ? 'open' : ''}>
                            <summary class="flex justify-between items-center w-full py-3 px-1 text-left font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer list-none">
                                <span>วันที่: ${event.date}</span>
                                <i data-lucide="chevron-down" class="w-5 h-5 transition-transform group-open:rotate-180"></i>
                            </summary>
                            <div class="p-4 bg-gray-50 dark:bg-gray-700/50 rounded-b-lg">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <h4 class="font-semibold mb-2 text-red-500 dark:text-red-400">Main Link Issues (${event.main.length})</h4>
                                        <ul class="list-disc list-inside text-sm space-y-1 text-gray-600 dark:text-gray-300">${event.main.length > 0 ? event.main.map(store => `<li key=${store.id}>${store.id} - ${store.name}</li>`).join('') : '<li>ไม่มี</li>'}</ul>
                                    </div>
                                    <div>
                                        <h4 class="font-semibold mb-2 text-blue-500 dark:text-blue-400">Backup 4G Issues (${event.backup.length})</h4>
                                        <ul class="list-disc list-inside text-sm space-y-1 text-gray-600 dark:text-gray-300">${event.backup.length > 0 ? event.backup.map(store => `<li key=${store.id}>${store.id} - ${store.name}</li>`).join('') : '<li>ไม่มี</li>'}</ul>
                                    </div>
                                </div>
                            </div>
                        </details>
                    </div>
                `).join('');
            },

            setupEventListeners() {
                document.getElementById('download-all-btn').addEventListener('click', () => {
                    const data = this.state.allEventsData;
                    if (data.length > 0) {
                        const headers = Object.keys(data[0]);
                        const csvRows = [headers.join(',')];
                        data.forEach(row => {
                            const values = headers.map(header => {
                                let cell = row[header] === null || row[header] === undefined ? '' : String(row[header]);
                                if (/[",\n]/.test(cell)) {
                                    cell = `"${cell.replace(/"/g, '""')}"`;
                                }
                                return cell;
                            });
                            csvRows.push(values.join(','));
                        });
                        const csvString = '\uFEFF' + csvRows.join('\n');
                        const blob = new Blob([csvString], { type: 'text/csv;charset=utf-8;' });
                        const link = document.createElement('a');
                        const url = URL.createObjectURL(blob);
                        link.setAttribute('href', url);
                        link.setAttribute('download', 'all_events_data.csv');
                        link.style.visibility = 'hidden';
                        document.body.appendChild(link);
                        link.click();
                        document.body.removeChild(link);
                    } else {
                        alert("ไม่มีข้อมูลสำหรับดาวน์โหลด");
                    }
                });
                document.getElementById('refresh-btn').addEventListener('click', () => this.init());
                
                document.getElementById('pagination-container').addEventListener('click', (e) => {
                    const button = e.target.closest('button');
                    if (!button || button.disabled) return;

                    const page = button.dataset.page;
                    if (page) {
                        this.state.pagination.currentPage = parseInt(page, 10);
                    } else if (button.id === 'prev-page') {
                        this.state.pagination.currentPage--;
                    } else if (button.id === 'next-page') {
                        this.state.pagination.currentPage++;
                    }
                    this.renderAttentionTable();
                });
            },

            async init() {
                const loadingOverlay = document.getElementById('loading-overlay');
                const dashboardContainer = document.getElementById('dashboard-container');
                
                loadingOverlay.style.display = 'flex';
                dashboardContainer.style.opacity = 0;

                await this.fetchData();
                this.render();
                this.setupEventListeners();
                
                document.getElementById('last-updated').textContent = `อัปเดตล่าสุด: ${new Date().toLocaleString('th-TH', { dateStyle: 'medium', timeStyle: 'short' })}`;

                loadingOverlay.style.display = 'none';
                dashboardContainer.style.opacity = 1;
            }
        };

        app.init();
    </script>
</body>
</html>
