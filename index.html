<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Up/Down Issues Summary Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Slate & Amber -->
    <!-- Application Structure Plan: ‡∏ú‡∏°‡πÑ‡∏î‡πâ‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡πÇ‡∏î‡∏¢‡πÅ‡∏ö‡πà‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô 3 ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏•‡∏±‡∏Å: 1. ‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏° (Key Metrics) ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î, 2. ‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏° (Charts) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡πÅ‡∏•‡∏∞‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤, ‡πÅ‡∏•‡∏∞ 3. ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏Ñ‡∏™ (Detailed Lists) ‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ ‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Å‡πà‡∏≠‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏à‡∏∂‡∏á‡πÄ‡∏à‡∏≤‡∏∞‡∏•‡∏∂‡∏Å‡∏•‡∏á‡πÑ‡∏õ‡πÉ‡∏ô‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏µ‡πà‡∏™‡∏ô‡πÉ‡∏à‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ ‡∏ã‡∏∂‡πà‡∏á‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏£‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß -->
    <!-- Visualization & Content Choices: 1. Key Metrics: (Goal: Inform) ‡πÉ‡∏ä‡πâ‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÇ‡∏î‡∏î‡πÄ‡∏î‡πà‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏á‡πà‡∏≤‡∏¢. 2. Daily Incidents Chart: (Goal: Change/Compare) ‡πÉ‡∏ä‡πâ‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏ó‡πà‡∏á‡πÅ‡∏ö‡∏ö‡∏ã‡πâ‡∏≠‡∏ô (Stacked Bar Chart) ‡∏à‡∏≤‡∏Å Chart.js ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏Ñ‡∏™‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤ Main Link ‡πÅ‡∏•‡∏∞ Backup 4G ‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏Å‡∏£‡∏≤‡∏ü‡πÄ‡∏î‡∏µ‡∏¢‡∏ß. 3. Problem Share Chart: (Goal: Compare) ‡πÉ‡∏ä‡πâ‡∏Å‡∏£‡∏≤‡∏ü‡πÇ‡∏î‡∏ô‡∏±‡∏ó (Doughnut Chart) ‡∏à‡∏≤‡∏Å Chart.js ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏™‡∏≠‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏´‡∏•‡∏±‡∏Å. 4. Incident Lists: (Goal: Organize/Inform) ‡πÉ‡∏ä‡πâ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢ HTML/Tailwind ‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏î‡πâ‡∏ß‡∏¢ JavaScript ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏Ñ‡∏™‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤ ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body { font-family: 'Sarabun', sans-serif; }
        .chart-container { position: relative; width: 100%; max-width: 800px; margin-left: auto; margin-right: auto; height: 350px; max-height: 50vh; }
        .tab-button.active { border-color: #f59e0b; color: #f59e0b; background-color: #fffbeb; }
        .tab-button { transition: all 0.2s ease-in-out; }
        .card-enter { animation: card-enter 0.5s ease-out forwards; }
        @keyframes card-enter {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            max-width: 90%;
            max-height: 90%;
            overflow-y: auto;
            position: relative;
        }
        .close-button {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            position: absolute;
            top: 10px;
            right: 20px;
            cursor: pointer;
        }
        .close-button:hover,
        .close-button:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <div class="container mx-auto p-4 md:p-8">
        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-slate-900">Up/Down Issues Summary Dashboard</h1>
            <p class="text-slate-500 mt-2">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏Ñ‡∏™ "UP/Down ‡∏ö‡πà‡∏≠‡∏¢‡∏Ñ‡∏£‡∏±‡πâ‡∏á Last 4 hours" ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1 - 4 ‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏° 2568</p>
        </header>

        <main>
            <!-- Date Range Filter -->
            <section class="bg-white p-4 md:p-6 rounded-xl shadow-sm border border-slate-200 mb-8">
                <h2 class="text-xl font-bold text-slate-800 mb-4 text-center">‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 items-end">
                    <div>
                        <label for="startDate" class="block text-sm font-medium text-slate-700 mb-1">‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</label>
                        <input type="date" id="startDate" class="w-full p-2 rounded-lg border border-slate-300 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 transition">
                    </div>
                    <div>
                        <label for="endDate" class="block text-sm font-medium text-slate-700 mb-1">‡∏ñ‡∏∂‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</label>
                        <input type="date" id="endDate" class="w-full p-2 rounded-lg border border-slate-300 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 transition">
                    </div>
                    <div>
                        <button id="applyFilterBtn" class="w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-2.5 px-4 rounded-lg shadow-md transition duration-200 ease-in-out transform hover:scale-105">
                            ‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                        </button>
                    </div>
                </div>
            </section>

            <!-- Key Metrics Section -->
            <section id="key-metrics" class="grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-6 mb-8">
                <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200 text-center card-enter" title="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î">
                    <h3 class="text-slate-500 text-sm md:text-base font-semibold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏Ñ‡∏™‡∏ó‡∏µ‡πà‡πÅ‡∏à‡πâ‡∏á</h3>
                    <p id="total-incidents" class="text-3xl md:text-4xl font-bold text-slate-900 mt-1"></p>
                </div>
                <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200 text-center card-enter" style="animation-delay: 0.3s;" title="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏¢‡∏ñ‡∏π‡∏Å‡πÅ‡∏à‡πâ‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤">
                    <h3 class="text-slate-500 text-sm md:text-base font-semibold">‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö</h3>
                    <p id="total-affected-stores" class="text-3xl md:text-4xl font-bold text-slate-900 mt-1"></p>
                </div>
                <!-- New Metric Cards -->
                <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200 text-center card-enter" style="animation-delay: 0.4s;" title="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Ticket ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡πÉ‡∏ô‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô">
                    <h3 class="text-slate-500 text-sm md:text-base font-semibold">True Ticket</h3>
                    <p id="total-tickets" class="text-3xl md:text-4xl font-bold text-purple-600 mt-1"></p>
                </div>
                <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200 text-center card-enter" style="animation-delay: 0.5s;" title="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô True CID ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤ Main Link">
                    <h3 class="text-slate-500 text-sm md:text-base font-semibold">True CID (Main Link)</h3>
                    <p id="total-true-cids-main-link" class="text-3xl md:text-4xl font-bold text-blue-600 mt-1"></p>
                </div>
                <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200 text-center card-enter" style="animation-delay: 0.6s;" title="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô True CID ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤ Backup Link">
                    <h3 class="text-slate-500 text-sm md:text-base font-semibold">True CID (Backup Link)</h3>
                    <p id="total-true-cids-backup-4g" class="text-3xl md:text-4xl font-bold text-amber-600 mt-1"></p>
                </div>
                <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200 text-center card-enter cursor-pointer hover:bg-slate-100 transition" style="animation-delay: 0.8s;" id="duplicate-stores-card" title="‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏Ç‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏à‡πâ‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô">
                    <h3 class="text-slate-500 text-sm md:text-base font-semibold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏≤‡∏Ç‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô</h3>
                    <p id="total-duplicate-stores" class="text-3xl md:text-4xl font-bold text-orange-600 mt-1"></p>
                </div>
                <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200 text-center card-enter" style="animation-delay: 0.9s;" id="total-affected-provinces-card" title="‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö">
                    <h3 class="text-slate-500 text-sm md:text-base font-semibold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö</h3>
                    <p id="total-affected-provinces" class="text-3xl md:text-4xl font-bold text-teal-600 mt-1"></p>
                </div>
                <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200 text-center card-enter" style="animation-delay: 1.0s;" id="total-affected-regions-card" title="‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏†‡∏≤‡∏Ñ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö">
                    <h3 class="text-slate-500 text-sm md:text-base font-semibold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏†‡∏≤‡∏Ñ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö</h3>
                    <p id="total-affected-regions" class="text-3xl md:text-4xl font-bold text-indigo-600 mt-1"></p>
                </div>
                <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200 text-center col-span-2 md:col-span-4 card-enter" style="animation-delay: 1.1s;">
                    <h3 class="text-slate-500 text-sm md:text-base font-semibold">‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏û‡∏ö</h3>
                    <p class="text-xl md:text-2xl font-bold text-slate-900 mt-1">UP/Down ‡∏ö‡πà‡∏≠‡∏¢‡∏Ñ‡∏£‡∏±‡πâ‡∏á Last 4 hours</p>
                </div>
            </section>

            <!-- Charts Section -->
            <section id="charts-section" class="bg-white p-4 md:p-6 rounded-xl shadow-sm border border-slate-200 mb-8">
                 <div class="w-full text-center mb-4">
                     <h2 class="text-xl font-bold text-slate-800">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏õ‡∏±‡∏ç‡∏´‡∏≤</h2>
                     <p class="text-slate-500 text-sm">‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏£‡∏∏‡∏õ‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏£‡∏≤‡∏ü ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡πÅ‡∏•‡∏∞‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ß‡∏±‡∏ô‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô</p>
                 </div>
                <div class="grid md:grid-cols-2 gap-8">
                    <div>
                        <h3 class="font-bold text-center mb-2 text-slate-700">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</h3>
                        <div class="chart-container h-72 md:h-80">
                            <canvas id="dailyIncidentsChart"></canvas>
                        </div>
                    </div>
                    <div>
                        <h3 class="font-bold text-center mb-2 text-slate-700">‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö</h3>
                        <div class="chart-container h-72 md:h-80">
                            <canvas id="problemTypeChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Details Section -->
            <section id="details-section" class="bg-white p-4 md:p-6 rounded-xl shadow-sm border border-slate-200">
                <div class="w-full text-center mb-4">
                     <h2 class="text-xl font-bold text-slate-800">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏Ñ‡∏™‡∏õ‡∏±‡∏ç‡∏´‡∏≤</h2>
                     <p class="text-slate-500 text-sm">‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏≤‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™ ‡πÅ‡∏•‡∏∞‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏Ñ‡∏™‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</p>
                 </div>

                <div class="mb-6 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4">
                    <input type="text" id="searchInput" placeholder="üîé ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏´‡∏£‡∏∑‡∏≠‡∏ä‡∏∑‡πà‡∏≠‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤..." class="w-full p-3 rounded-lg border border-slate-300 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 transition col-span-full xl:col-span-2">
                    
                    <input type="text" id="trueCidFilterInput" placeholder="üîé ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ True CID..." class="w-full p-3 rounded-lg border border-slate-300 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 transition col-span-full xl:col-span-1">

                    <select id="problemTypeFilter" class="w-full p-3 rounded-lg border border-slate-300 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 transition">
                        <option value="">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏õ‡∏±‡∏ç‡∏´‡∏≤: ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                        <option value="Main Link">Main Link</option>
                        <option value="Backup 4G">Backup 4G</option>
                    </select>
                    <select id="ticketStatusFilter" class="w-full p-3 rounded-lg border border-slate-300 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 transition">
                        <option value="">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Ticket: ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                        <option value="hasTicket">‡∏°‡∏µ Ticket</option>
                        <option value="noTicket">‡πÑ‡∏°‡πà‡∏°‡∏µ Ticket</option>
                    </select>
                    <select id="remarkStatusFilter" class="w-full p-3 rounded-lg border border-slate-300 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 transition">
                        <option value="">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Remark: ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                        <option value="hasRemark">‡∏°‡∏µ Remark</option>
                        <option value="noRemark">‡πÑ‡∏°‡πà‡∏°‡∏µ Remark</option>
                    </select>
                    <select id="provinceFilter" class="w-full p-3 rounded-lg border border-slate-300 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 transition">
                        <option value="">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î: ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                        <!-- Options populated by JS -->
                    </select>
                    <select id="regionFilter" class="w-full p-3 rounded-lg border border-slate-300 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 transition">
                        <option value="">‡∏†‡∏≤‡∏Ñ: ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                        <!-- Options populated by JS -->
                    </select>

                    <button id="downloadCsvBtn" class="bg-amber-500 hover:bg-amber-600 text-white font-bold py-3 px-6 rounded-lg shadow-md transition duration-200 ease-in-out transform hover:scale-105 col-span-full">
                        ‚¨áÔ∏è ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (CSV)
                    </button>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h3 class="text-lg font-bold mb-4 text-blue-700">üö® ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ Main Link</h3>
                        <div id="main-link-list" class="space-y-4 max-h-[60vh] overflow-y-auto pr-2"></div>
                    </div>
                    <div>
                        <h3 class="text-lg font-bold mb-4 text-amber-700">üì° ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ Backup 4G</h3>
                        <div id="backup-4g-list" class="space-y-4 max-h-[60vh] overflow-y-auto pr-2"></div>
                    </div>
                </div>
                <div id="no-results" class="text-center py-12 text-slate-500 hidden">
                    <p class="text-lg font-semibold">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</p>
                    <p>‡∏•‡∏≠‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</p>
                </div>
            </section>

        </main>
    </div>

    <!-- Duplicate Stores Modal -->
    <div id="duplicateStoresModal" class="modal">
        <div class="modal-content w-11/12 md:w-2/3 lg:w-1/2">
            <span class="close-button">&times;</span>
            <h2 class="text-2xl font-bold text-slate-900 mb-4">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏Ç‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô</h2>
            <p class="text-slate-600 mb-4">‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÉ‡∏ô‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</p>
            <ul id="duplicate-stores-list" class="space-y-2">
                <!-- Duplicate stores will be listed here -->
            </ul>
        </div>
    </div>

    <!-- Affected Provinces Modal -->
    <div id="affectedProvincesModal" class="modal">
        <div class="modal-content w-11/12 md:w-2/3 lg:w-1/2">
            <span class="close-button">&times;</span>
            <h2 class="text-2xl font-bold text-slate-900 mb-4">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö</h2>
            <p class="text-slate-600 mb-4">‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏≤‡∏Ç‡∏≤‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏á</p>
            <ul id="affected-provinces-list" class="space-y-2">
                <!-- Affected provinces will be listed here -->
            </ul>
        </div>
    </div>

    <!-- Affected Regions Modal -->
    <div id="affectedRegionsModal" class="modal">
        <div class="modal-content w-11/12 md:w-2/3 lg:w-1/2">
            <span class="close-button">&times;</span>
            <h2 class="text-2xl font-bold text-slate-900 mb-4">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏†‡∏≤‡∏Ñ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö</h2>
            <p class="text-slate-600 mb-4">‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏†‡∏≤‡∏Ñ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏≤‡∏Ç‡∏≤‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏á</p>
            <ul id="affected-regions-list" class="space-y-2">
                <!-- Affected regions will be listed here -->
            </ul>
        </div>
    </div>

    <script>
        // Mock Store Location Data (Province and Region)
        // This data is for demonstration purposes. You should replace it with your actual, comprehensive location data.
        const storeLocations = {
            '6300': { province: '‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏ó‡∏±‡∏ö‡∏Å‡∏ß‡∏≤‡∏á
            '16081': { province: '‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ', region: '‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å' }, // PTTOR ‡∏ó‡∏∏‡πà‡∏á‡∏Ç‡∏ß‡∏≤‡∏á-‡∏û‡∏ô‡∏±‡∏™ (‡∏ó‡∏•.349)
            '16740': { province: '‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏ö‡πâ‡∏≤‡∏ô‡πÑ‡∏™‡∏°‡πà‡∏ß‡∏á (Mocked, assuming same as Thap Kwang region)
            '11685': { province: '‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏û‡∏µ‡∏£‡∏û‡∏á‡∏©‡πå (BW) - common name, mocked to BKK
            '13098': { province: '‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏ñ‡∏ô‡∏ô‡∏Ç‡πâ‡∏≤‡∏ß‡∏õ‡∏•‡∏π‡∏Å (RC) - common name, mocked to BKK
            '13367': { province: '‡∏ä‡∏∏‡∏°‡∏û‡∏£', region: '‡πÉ‡∏ï‡πâ' }, // ‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏ö‡∏≤‡∏á‡∏•‡∏∂‡∏Å
            '6636': { province: '‡∏™‡∏∏‡∏£‡∏≤‡∏©‡∏é‡∏£‡πå‡∏ò‡∏≤‡∏ô‡∏µ', region: '‡πÉ‡∏ï‡πâ' }, // ‡∏ó‡πà‡∏≤‡∏ó‡∏≠‡∏á
            '8484': { province: '‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÄ‡∏û‡∏ä‡∏£', region: '‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // ‡∏õ‡∏ï‡∏ó.‡∏Ñ‡∏µ‡∏£‡∏µ‡∏°‡∏≤‡∏® (Mocked)
            '9188': { province: '‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏™‡∏µ‡πà‡πÅ‡∏¢‡∏Å‡∏ö‡πà‡∏≠‡∏ô‡πÑ‡∏Å‡πà ‡∏à‡∏∏‡∏î 2 (Mocked)
            '15903': { province: '‡∏†‡∏π‡πÄ‡∏Å‡πá‡∏ï', region: '‡πÉ‡∏ï‡πâ' }, // ‡∏ã‡∏≠‡∏¢‡∏ö‡∏≤‡∏á‡πÄ‡∏ó‡∏≤ 2
            '16502': { province: '‡∏™‡∏£‡∏∞‡πÅ‡∏Å‡πâ‡∏ß', region: '‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å' }, // ‡∏£‡∏û.‡∏ß‡∏±‡∏í‡∏ô‡∏≤‡∏ô‡∏Ñ‡∏£ ( ‡∏™‡∏£‡∏∞‡πÅ‡∏Å‡πâ‡∏ß )
            '7085': { province: '‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏î‡∏≠‡∏ô‡∏´‡∏ß‡∏≤‡∏¢ (Mocked)
            '1157': { province: '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà', region: '‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // ‡∏ï‡πâ‡∏ô‡∏û‡∏¢‡∏≠‡∏°
            '16759': { province: '‡∏à‡∏±‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ', region: '‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å' }, // PTTOR ‡∏´‡∏ô‡∏≠‡∏á‡∏≠‡πâ‡∏≠ ‡∏à‡∏±‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ
            '1692': { province: '‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏û‡∏∏‡∏ó‡∏ò‡∏°‡∏ì‡∏ë‡∏•‡∏™‡∏≤‡∏¢ 7
            '3921': { province: '‡πÄ‡∏û‡∏ä‡∏£‡∏ö‡∏π‡∏£‡∏ì‡πå', region: '‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // ‡∏ï‡∏•‡∏≤‡∏î‡πÇ‡∏û‡∏ò‡∏¥‡πå‡∏™‡∏∏‡∏ß‡∏£‡∏£‡∏ì
            '10567': { province: '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢', region: '‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // ‡∏û‡∏•‡∏°‡∏≤‡∏ô‡∏µ‡∏¢‡πå ‡∏à‡∏∏‡∏î 4
            '11351': { province: '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà', region: '‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // ‡∏ö‡πâ‡∏≤‡∏ô‡∏™‡∏ö‡πÄ‡∏õ‡∏¥‡∏á (‡∏≠.‡πÅ‡∏°‡πà‡πÅ‡∏ï‡∏á)
            '5057': { province: '‡∏°‡∏∏‡∏Å‡∏î‡∏≤‡∏´‡∏≤‡∏£', region: '‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // ‡∏Ñ‡∏≥‡∏ä‡∏∞‡∏≠‡∏µ
            '5282': { province: '‡∏•‡∏≥‡∏û‡∏π‡∏ô', region: '‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // ‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏á‡∏á‡πà‡∏≤
            '15947': { province: '‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏õ‡∏≤‡∏Å‡∏ó‡∏≤‡∏á‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏¥‡∏ô‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÅ‡∏™‡∏ô
            '12003': { province: '‡∏ï‡∏≤‡∏Å', region: '‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // ‡∏õ‡∏ï‡∏ó.‡πÅ‡∏°‡πà‡∏õ‡∏∞
            '15850': { province: '‡∏ä‡∏∏‡∏°‡∏û‡∏£', region: '‡πÉ‡∏ï‡πâ' }, // ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡πà‡∏≤‡∏¢‡πÄ‡∏Ç‡∏ï‡∏≠‡∏∏‡∏î‡∏°‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå (SN)
            '7331': { province: '‡∏û‡∏£‡∏∞‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏≠‡∏¢‡∏∏‡∏ò‡∏¢‡∏≤', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏õ‡∏ï‡∏ó.‡∏û‡∏´‡∏•‡πÇ‡∏¢‡∏ò‡∏¥‡∏ô‡∏ß‡∏±‡∏á‡∏ô‡πâ‡∏≠‡∏¢ ‡∏Å‡∏°.78
            '13044': { province: '‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏ô‡∏≤‡∏î‡∏µ (BW)
            '16634': { province: '‡∏™‡∏∏‡πÇ‡∏Ç‡∏ó‡∏±‡∏¢', region: '‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // ‡∏£‡∏û.‡∏™‡∏∏‡πÇ‡∏Ç‡∏ó‡∏±‡∏¢
            '1012': { province: '‡∏û‡∏£‡∏∞‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏≠‡∏¢‡∏∏‡∏ò‡∏¢‡∏≤', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏ß‡∏±‡∏î‡∏û‡∏£‡∏∞‡∏ç‡∏≤‡∏ï‡∏¥
            '9864': { province: '‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å', region: '‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // ‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å‡∏û‡∏•‡∏≤‡∏ã‡πà‡∏≤
            '10087': { province: '‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å', region: '‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // ‡∏õ‡∏ï‡∏ó.‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å
            '13886': { province: '‡∏ô‡∏Ñ‡∏£‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå', region: '‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // ‡∏õ‡∏ï‡∏ó.‡∏´‡∏ô‡∏≠‡∏á‡∏ö‡∏±‡∏ß (NC)
            '12108': { province: '‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏û‡∏∏‡∏ó‡∏ò‡∏°‡∏ì‡∏ë‡∏•‡∏™‡∏≤‡∏¢ 2 ‡∏ã‡∏≠‡∏¢ 2 (BW)
            '4312': { province: '‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏ã‡∏≠‡∏¢‡∏ô‡∏ß‡∏•‡∏à‡∏¥‡∏ï‡∏£ ‡∏à‡∏∏‡∏î 2
            '4728': { province: '‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏ô‡∏†‡∏≤‡∏à‡∏£‡∏±‡∏™
            '14222': { province: '‡πÄ‡∏•‡∏¢', region: '‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // PTTOR ‡∏î‡πà‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢ (NE)
            '11801': { province: '‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÄ‡∏û‡∏ä‡∏£', region: '‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // ‡∏õ‡∏ï‡∏ó.‡∏´‡∏ô‡∏≠‡∏á‡∏õ‡∏•‡∏¥‡∏á‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÄ‡∏û‡∏ä‡∏£ (RC)
            '3225': { province: '‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏ò‡∏£‡∏£‡∏°‡∏à‡∏±‡∏Å‡∏£
            '11833': { province: '‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // Cargill Factory Market
            '10299': { province: '‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // DC ‡∏°‡∏´‡∏≤‡∏ä‡∏±‡∏¢
            '10342': { province: '‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÄ‡∏û‡∏ä‡∏£', region: '‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // ‡∏£‡∏≤‡∏ä‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô (‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÄ‡∏û‡∏ä‡∏£)
            '1230': { province: '‡∏ô‡∏Ñ‡∏£‡∏£‡∏≤‡∏ä‡∏™‡∏µ‡∏°‡∏≤', region: '‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // ‡∏™‡∏±‡∏ô‡∏ï‡∏¥‡∏™‡∏∏‡∏Ç
            '3144': { province: '‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏õ‡∏ï‡∏ó.‡∏´‡∏¥‡∏ô‡∏Å‡∏≠‡∏á
            '15621': { province: '‡∏•‡∏û‡∏ö‡∏∏‡∏£‡∏µ', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // PTTOR ‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏°‡∏û‡∏¥‡πÄ‡∏®‡∏© (RC)(‡∏õ‡∏ï‡∏ó.100%)
            '5094': { province: '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢', region: '‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // FR.‡∏ö‡πâ‡∏≤‡∏ô‡∏®‡∏£‡∏µ‡∏î‡∏≠‡∏ô‡πÑ‡∏ä‡∏¢ 1
            '16252': { province: '‡∏£‡∏≤‡∏ä‡∏ö‡∏∏‡∏£‡∏µ', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏ï‡∏•‡∏≤‡∏î‡∏£‡∏∏‡πà‡∏á‡πÇ‡∏£‡∏à‡∏ô‡πå‡πÄ‡∏à‡∏£‡∏¥‡∏ç‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå
            '992': { province: '‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏ï‡∏•‡∏≤‡∏î‡∏™‡∏≥‡πÄ‡∏´‡∏£‡πà
            '15414': { province: '‡∏ô‡∏Ñ‡∏£‡∏£‡∏≤‡∏ä‡∏™‡∏µ‡∏°‡∏≤', region: '‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // ‡∏ò‡∏≤‡∏£‡∏≤‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏î‡πÄ‡∏ó‡∏• 3 (NE)
            '8572': { province: '‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏£‡∏û.‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û(‡∏û‡∏•‡∏≤‡∏ã‡πà‡∏≤)
            '13419': { province: '‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // GAYSORN OFFICE TOWER (BW)
            '338': { province: '‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏ï‡∏•‡∏≤‡∏î‡∏û‡∏•‡∏π
            '5840': { province: '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà', region: '‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // ‡∏õ‡∏ï‡∏ó.‡∏ô‡πâ‡∏≥‡πÅ‡∏û‡∏£‡πà
            '17054': { province: '‡∏£‡∏≤‡∏ä‡∏ö‡∏∏‡∏£‡∏µ', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // PTTOR ‡πÄ‡∏Ç‡∏≤‡∏ß‡∏±‡∏á (‡∏£‡∏≤‡∏ä‡∏ö‡∏∏‡∏£‡∏µ)
            '16016': { province: '‡∏™‡∏∏‡∏û‡∏£‡∏£‡∏ì‡∏ö‡∏∏‡∏£‡∏µ', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏®‡∏£‡∏µ‡∏õ‡∏£‡∏∞‡∏à‡∏±‡∏ô‡∏ï‡πå
            '5000': { province: '‡∏ï‡∏≤‡∏Å', region: '‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // ‡∏ï‡∏≤‡∏Å‡∏û‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°
            '5583': { province: '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà', region: '‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // ‡∏ï‡∏•‡∏≤‡∏î‡∏õ‡∏•‡∏≤‡∏ä‡∏°‡∏†‡∏π‡∏û‡∏á‡∏®‡πå
            '7695': { province: '‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏ö‡∏∏‡∏£‡∏µ', region: '‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏ï‡∏Å' }, // ‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡πå
            '2159': { province: '‡∏™‡∏¥‡∏á‡∏´‡πå‡∏ö‡∏∏‡∏£‡∏µ', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏ö‡∏Ç‡∏™.‡∏™‡∏¥‡∏á‡∏´‡πå‡∏ö‡∏∏‡∏£‡∏µ
            '6927': { province: '‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏ã‡∏≠‡∏¢‡∏õ‡∏£‡∏∞‡∏ó‡∏≤‡∏ô‡∏û‡∏£
            '9307': { province: '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà', region: '‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // ‡∏ö‡πâ‡∏≤‡∏ô‡∏´‡∏ô‡∏≠‡∏á‡πÇ‡∏Ñ‡πâ‡∏á
            '4172': { province: '‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏õ‡∏ï‡∏ó.‡∏ô‡∏Ñ‡∏£‡∏ä‡∏±‡∏¢‡∏®‡∏£‡∏µ
            '6186': { province: '‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏°.‡∏û‡∏§‡∏Å‡∏©‡∏≤‡∏ß‡∏¥‡∏•‡∏•‡πå 63-‡∏û‡∏£‡∏∞‡∏£‡∏≤‡∏° 5
            '8145': { province: '‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏™‡∏°‡πÄ‡∏î‡πá‡∏à‡∏û‡∏£‡∏∞‡πÄ‡∏ó‡∏û‡∏£‡∏±‡∏ï‡∏ô‡πå(‡∏£.‡∏û.‡∏£‡∏≤‡∏°‡∏≤‡∏Ø)
            '13428': { province: '‡∏•‡∏û‡∏ö‡∏∏‡∏£‡∏µ', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ô‡∏¥‡∏Ñ‡∏°‡∏™‡∏≤‡∏¢ 4 (‡πÄ‡∏Ç‡∏≤‡∏™‡∏π‡∏á) (RC)
            '16045': { province: '‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ', region: '‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å' }, // PTTOR ‡πÅ‡∏¢‡∏Å‡∏ö‡πâ‡∏≤‡∏ô‡∏ö‡∏∂‡∏á
            '17058': { province: '‡∏ô‡∏Ñ‡∏£‡∏£‡∏≤‡∏ä‡∏™‡∏µ‡∏°‡∏≤', region: '‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // ‡∏Ç‡∏ô‡∏á‡∏û‡∏£‡∏∞‡πÉ‡∏ï‡πâ
            '8358': { province: '‡∏≠‡∏∏‡∏î‡∏£‡∏ò‡∏≤‡∏ô‡∏µ', region: '‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // ‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏∏‡∏î‡∏£‡∏ó‡∏¥‡∏û‡∏¢‡πå
            '11174': { province: '‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏ö‡∏∏‡∏£‡∏µ', region: '‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏ï‡∏Å' }, // ‡∏ó‡πà‡∏≤‡πÑ‡∏°‡πâ
            '3804': { province: '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà', region: '‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // ‡∏õ‡∏ï‡∏ó‡∏´‡∏ô‡∏≠‡∏á‡∏ú‡∏∂‡πâ‡∏á
            '16267': { province: '‡∏≠‡πà‡∏≤‡∏á‡∏ó‡∏≠‡∏á', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏≠‡∏á‡∏Ñ‡∏£‡∏±‡∏Å‡∏©‡πå ‡∏≠‡πà‡∏≤‡∏á‡∏ó‡∏≠‡∏á
            '16765': { province: '‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏à‡∏£‡∏¥‡∏ç‡∏™‡∏∏‡∏Ç(‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÅ‡∏™‡∏ô)
            '544': { province: '‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏ö‡∏∏‡∏£‡∏µ', region: '‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏ï‡∏Å' }, // ‡∏£‡∏¥‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÅ‡∏Ñ‡∏ß
            '16774': { province: '‡∏™‡∏á‡∏Ç‡∏•‡∏≤', region: '‡πÉ‡∏ï‡πâ' }, // PTTOR ‡πÄ‡∏Ç‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß (‡∏™‡∏¥‡∏á‡∏´‡∏ô‡∏Ñ‡∏£)
            '16650': { province: '‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡πÄ‡∏õ‡πÇ‡∏ï‡∏£-‡∏î‡∏á‡πÄ‡∏Å‡∏ï‡∏∏
            '17034': { province: '‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏≤‡∏†‡∏¥‡πÄ‡∏©‡∏Å ‡πÇ‡∏ã‡∏ô C
            '5072': { province: '‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å', region: '‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // ‡∏û‡∏£‡∏∞‡∏≠‡∏á‡∏Ñ‡πå‡∏î‡∏≥(‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å)
            '4673': { province: '‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô', region: '‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // ‡∏≠‡∏î‡∏∏‡∏•‡∏¢‡∏≤‡∏£‡∏≤‡∏°
            '11107': { province: '‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏™‡∏∏‡∏Ç‡∏∏‡∏°‡∏ß‡∏¥‡∏ó 66 (BS)
            '11942': { province: '‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // SV ‡∏û‡∏£‡∏∞‡∏£‡∏≤‡∏° 3
            '11470': { province: '‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ', region: '‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å' }, // ‡∏Ñ‡∏•‡∏≠‡∏á‡∏ï‡∏≥‡∏´‡∏£‡∏∏ 5 (‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ)
            '3648': { province: '‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏ã‡∏≠‡∏¢‡∏ö‡∏≤‡∏î‡∏≤‡∏•
            '5566': { province: '‡∏õ‡∏ó‡∏∏‡∏°‡∏ò‡∏≤‡∏ô‡∏µ', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏õ‡∏ó‡∏∏‡∏°‡∏ó‡∏≠‡∏á 2
            '8629': { province: '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà', region: '‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // ‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏°‡∏´‡∏≤‡∏£‡∏≤‡∏ä (‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà)
            '11399': { province: '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà', region: '‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // ‡πÅ‡∏¢‡∏Å‡∏™‡∏ô‡∏≤‡∏°‡∏ö‡∏¥‡∏ô2
            '13952': { province: '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà', region: '‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // FR.‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏£‡∏≤‡∏ä‡πÄ‡∏ß‡∏ä (‡∏à.‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà)
            '16751': { province: '‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°', region: '‡∏Å‡∏•‡∏≤‡∏á' }, // ‡∏™‡∏≤‡∏°‡∏û‡∏£‡∏≤‡∏ô ‡∏ã‡∏≠‡∏¢ 2
            '9528': { province: '‡∏•‡∏≥‡∏õ‡∏≤‡∏á', region: '‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // ‡πÅ‡∏°‡πà‡∏ó‡∏∞
            '7016': { province: '‡∏õ‡∏£‡∏∞‡∏à‡∏ß‡∏ö‡∏Ñ‡∏µ‡∏£‡∏µ‡∏Ç‡∏±‡∏ô‡∏ò‡πå', region: '‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏ï‡∏Å' }, // ‡∏õ‡∏ï‡∏ó.‡∏ö‡∏≤‡∏á‡∏™‡∏∞‡∏û‡∏≤‡∏ô
            '2838': { province: '‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä', region: '‡πÉ‡∏ï‡πâ' }, // ‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏ó‡πà‡∏≤‡∏®‡∏≤‡∏•‡∏≤
            '8083': { province: '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà', region: '‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // ‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏™‡∏≤‡∏£‡∏†‡∏µ
            '11954': { province: '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà', region: '‡πÄ‡∏´‡∏ô‡∏∑‡∏≠' }, // ‡∏ï‡∏•‡∏≤‡∏î‡∏Ñ‡∏•‡∏±‡∏á‡∏°‡∏≤‡∏£‡πå‡πÄ‡∏ä‡πà
        };

        // Thai Regions Mapping (for mock data)
        const thaiRegions = {
            '‡πÄ‡∏´‡∏ô‡∏∑‡∏≠': ['‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢', '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà', '‡∏ô‡πà‡∏≤‡∏ô', '‡∏û‡∏∞‡πÄ‡∏¢‡∏≤', '‡πÅ‡∏û‡∏£‡πà', '‡πÅ‡∏°‡πà‡∏Æ‡πà‡∏≠‡∏á‡∏™‡∏≠‡∏ô', '‡∏•‡∏≥‡∏õ‡∏≤‡∏á', '‡∏•‡∏≥‡∏û‡∏π‡∏ô', '‡∏≠‡∏∏‡∏ï‡∏£‡∏î‡∏¥‡∏ï‡∏ñ‡πå', '‡∏™‡∏∏‡πÇ‡∏Ç‡∏ó‡∏±‡∏¢', '‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å', '‡∏û‡∏¥‡∏à‡∏¥‡∏ï‡∏£', '‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÄ‡∏û‡∏ä‡∏£', '‡πÄ‡∏û‡∏ä‡∏£‡∏ö‡∏π‡∏£‡∏ì‡πå', '‡∏ô‡∏Ñ‡∏£‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå', '‡∏≠‡∏∏‡∏ó‡∏±‡∏¢‡∏ò‡∏≤‡∏ô‡∏µ', '‡∏ï‡∏≤‡∏Å'],
            '‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡πÄ‡∏´‡∏ô‡∏∑‡∏≠': ['‡∏Å‡∏≤‡∏¨‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå', '‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô', '‡∏ä‡∏±‡∏¢‡∏†‡∏π‡∏°‡∏¥', '‡∏ô‡∏Ñ‡∏£‡∏û‡∏ô‡∏°', '‡∏ô‡∏Ñ‡∏£‡∏£‡∏≤‡∏ä‡∏™‡∏µ‡∏°‡∏≤', '‡∏ö‡∏∂‡∏á‡∏Å‡∏≤‡∏¨', '‡∏ö‡∏∏‡∏£‡∏µ‡∏£‡∏±‡∏°‡∏¢‡πå', '‡∏°‡∏´‡∏≤‡∏™‡∏≤‡∏£‡∏Ñ‡∏≤‡∏°', '‡∏°‡∏∏‡∏Å‡∏î‡∏≤‡∏´‡∏≤‡∏£', '‡∏¢‡πÇ‡∏™‡∏ò‡∏£', '‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î', '‡πÄ‡∏•‡∏¢', '‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©', '‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£', '‡∏™‡∏∏‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå', '‡∏´‡∏ô‡∏≠‡∏á‡∏Ñ‡∏≤‡∏¢', '‡∏´‡∏ô‡∏≠‡∏á‡∏ö‡∏±‡∏ß‡∏•‡∏≥‡∏†‡∏π', '‡∏≠‡∏∏‡∏î‡∏£‡∏ò‡∏≤‡∏ô‡∏µ', '‡∏≠‡∏∏‡∏ö‡∏•‡∏£‡∏≤‡∏ä‡∏ò‡∏≤‡∏ô‡∏µ', '‡∏≠‡∏≥‡∏ô‡∏≤‡∏à‡πÄ‡∏à‡∏£‡∏¥‡∏ç'],
            '‡∏Å‡∏•‡∏≤‡∏á': ['‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£', '‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏ö‡∏∏‡∏£‡∏µ', '‡∏ä‡∏±‡∏¢‡∏ô‡∏≤‡∏ó', '‡∏ô‡∏Ñ‡∏£‡∏ô‡∏≤‡∏¢‡∏Å', '‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°', '‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ', '‡∏õ‡∏ó‡∏∏‡∏°‡∏ò‡∏≤‡∏ô‡∏µ', '‡∏û‡∏£‡∏∞‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏≠‡∏¢‡∏∏‡∏ò‡∏¢‡∏≤', '‡πÄ‡∏û‡∏ä‡∏£‡∏ö‡∏∏‡∏£‡∏µ', '‡∏£‡∏≤‡∏ä‡∏ö‡∏∏‡∏£‡∏µ', '‡∏•‡∏û‡∏ö‡∏∏‡∏£‡∏µ', '‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£', '‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏°', '‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£', '‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ', '‡∏™‡∏¥‡∏á‡∏´‡πå‡∏ö‡∏∏‡∏£‡∏µ', '‡∏™‡∏∏‡∏û‡∏£‡∏£‡∏ì‡∏ö‡∏∏‡∏£‡∏µ', '‡∏≠‡πà‡∏≤‡∏á‡∏ó‡∏≠‡∏á'],
            '‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å': ['‡∏à‡∏±‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ', '‡∏â‡∏∞‡πÄ‡∏ä‡∏¥‡∏á‡πÄ‡∏ó‡∏£‡∏≤', '‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ', '‡∏ï‡∏£‡∏≤‡∏î', '‡∏õ‡∏£‡∏≤‡∏à‡∏µ‡∏ô‡∏ö‡∏∏‡∏£‡∏µ', '‡∏£‡∏∞‡∏¢‡∏≠‡∏á', '‡∏™‡∏£‡∏∞‡πÅ‡∏Å‡πâ‡∏ß'],
            '‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏ï‡∏Å': ['‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏ö‡∏∏‡∏£‡∏µ', '‡∏ï‡∏≤‡∏Å', '‡∏õ‡∏£‡∏∞‡∏à‡∏ß‡∏ö‡∏Ñ‡∏µ‡∏£‡∏µ‡∏Ç‡∏±‡∏ô‡∏ò‡πå', '‡πÄ‡∏û‡∏ä‡∏£‡∏ö‡∏∏‡∏£‡∏µ', '‡∏£‡∏≤‡∏ä‡∏ö‡∏∏‡∏£‡∏µ'],
            '‡πÉ‡∏ï‡πâ': ['‡∏Å‡∏£‡∏∞‡∏ö‡∏µ‡πà', '‡∏ä‡∏∏‡∏°‡∏û‡∏£', '‡∏ï‡∏£‡∏±‡∏á', '‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä', '‡∏ô‡∏£‡∏≤‡∏ò‡∏¥‡∏ß‡∏≤‡∏™', '‡∏õ‡∏±‡∏ï‡∏ï‡∏≤‡∏ô‡∏µ', '‡∏û‡∏±‡∏á‡∏á‡∏≤', '‡∏û‡∏±‡∏ó‡∏•‡∏∏‡∏á', '‡∏†‡∏π‡πÄ‡∏Å‡πá‡∏ï', '‡∏¢‡∏∞‡∏•‡∏≤', '‡∏£‡∏∞‡∏ô‡∏≠‡∏á', '‡∏™‡∏á‡∏Ç‡∏•‡∏≤', '‡∏™‡∏ï‡∏π‡∏•', '‡∏™‡∏∏‡∏£‡∏≤‡∏©‡∏é‡∏£‡πå‡∏ò‡∏≤‡∏ô‡∏µ']
        };

        // Function to get region from province
        function getRegion(province) {
            for (const region in thaiRegions) {
                if (thaiRegions[region].includes(province)) {
                    return region;
                }
            }
            return '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏†‡∏≤‡∏Ñ'; // Default if not found
        }

        // Raw CSV data from the uploaded file
        const rawCsvData = `Date,Time,Ticket,True CID,Problem Type,Store ID,Store Name,Remark
01/07/2025,15:32,,U16936,Main Link,6300,‡∏ó‡∏±‡∏ö‡∏Å‡∏ß‡∏≤‡∏á,
01/07/2025,15:32,,U67732,Main Link,16081,PTTOR ‡∏ó‡∏∏‡πà‡∏á‡∏Ç‡∏ß‡∏≤‡∏á-‡∏û‡∏ô‡∏±‡∏™ (‡∏ó‡∏•.349),
01/07/2025,15:32,,U99207,Main Link,16740,‡∏ö‡πâ‡∏≤‡∏ô‡πÑ‡∏™‡∏°‡πà‡∏ß‡∏á,
01/07/2025,15:32,,V24556B,Main Link,11685,‡∏û‡∏µ‡∏£‡∏û‡∏á‡∏©‡πå (BW),
01/07/2025,15:32,,U61365,Main Link,13098,‡∏ñ‡∏ô‡∏ô‡∏Ç‡πâ‡∏≤‡∏ß‡∏õ‡∏•‡∏π‡∏Å (RC),
01/07/2025,15:32,,WDS27348,Backup 4G,13367,‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏ö‡∏≤‡∏á‡∏•‡∏∂‡∏Å,
01/07/2025,15:32,,WDS14790,Backup 4G,6636,‡∏ó‡πà‡∏≤‡∏ó‡∏≠‡∏á,
01/07/2025,15:32,,WDS25626,Backup 4G,8484,‡∏õ‡∏ï‡∏ó.‡∏Ñ‡∏µ‡∏£‡∏µ‡∏°‡∏≤‡∏®,
01/07/2025,15:32,,WDS27602,Backup 4G,9188,‡∏™‡∏µ‡πà‡πÅ‡∏¢‡∏Å‡∏ö‡πà‡∏≠‡∏ô‡πÑ‡∏Å‡πà ‡∏à‡∏∏‡∏î 2,
01/07/2025,15:32,,WDS31050,Backup 4G,15903,‡∏ã‡∏≠‡∏¢‡∏ö‡∏≤‡∏á‡πÄ‡∏ó‡∏≤ 2,
01/07/2025,15:32,,WDS36644,Backup 4G,16502,‡∏£‡∏û.‡∏ß‡∏±‡∏í‡∏ô‡∏≤‡∏ô‡∏Ñ‡∏£ ( ‡∏™‡∏£‡∏∞‡πÅ‡∏Å‡πâ‡∏ß ),
01/07/2025,15:32,,WDS25187,Backup 4G,7085,‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏î‡∏≠‡∏ô‡∏´‡∏ß‡∏≤‡∏¢,
01/07/2025,15:32,,WDS25121,Backup 4G,1157,‡∏ï‡πâ‡∏ô‡∏û‡∏¢‡∏≠‡∏°,
01/07/2025,15:32,,WDS37397,Backup 4G,16759,PTTOR ‡∏´‡∏ô‡∏≠‡∏á‡∏≠‡πâ‡∏≠ ‡∏à‡∏±‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ,
01/07/2025,15:32,,WDS24888,Backup 4G,1692,‡∏û‡∏∏‡∏ó‡∏ò‡∏°‡∏ì‡∏ë‡∏•‡∏™‡∏≤‡∏¢ 7,
02/07/2025,09:38,,V92837B,Main Link,3921,‡∏ï‡∏•‡∏≤‡∏î‡πÇ‡∏û‡∏ò‡∏¥‡πå‡∏™‡∏∏‡∏ß‡∏£‡∏£‡∏ì,
02/07/2025,09:38,,V14346B,Main Link,10567,‡∏û‡∏•‡∏°‡∏≤‡∏ô‡∏µ‡∏¢‡πå ‡∏à‡∏∏‡∏î 4,
02/07/2025,09:38,,U20995,Main Link,11351,‡∏ö‡πâ‡∏≤‡∏ô‡∏™‡∏ö‡πÄ‡∏õ‡∏¥‡∏á (‡∏≠.‡πÅ‡∏°‡πà‡πÅ‡∏ï‡∏á),
02/07/2025,09:38,,U91348,Main Link,5057,‡∏Ñ‡∏≥‡∏ä‡∏∞‡∏≠‡∏µ,
02/07/2025,09:38,,U91897,Main Link,5282,‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏á‡∏á‡πà‡∏≤,
02/07/2025,09:39,,WDS32067,Backup 4G,15947,‡∏õ‡∏≤‡∏Å‡∏ó‡∏≤‡∏á‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏¥‡∏ô‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÅ‡∏™‡∏ô,
02/07/2025,09:39,,WDS23952,Backup 4G,12003,‡∏õ‡∏ï‡∏ó.‡πÅ‡∏°‡πà‡∏õ‡∏∞,
02/07/2025,09:39,,WDS30557,Backup 4G,15850,‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡πà‡∏≤‡∏¢‡∏Ñ‡πà‡∏≤‡∏¢‡πÄ‡∏Ç‡∏ï‡∏≠‡∏∏‡∏î‡∏°‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå (SN),
02/07/2025,09:39,,WDS23325,Backup 4G,7331,‡∏õ‡∏ï‡∏ó.‡∏û‡∏´‡∏•‡πÇ‡∏¢‡∏ò‡∏¥‡∏ô‡∏ß‡∏±‡∏á‡∏ô‡πâ‡∏≠‡∏¢ ‡∏Å‡∏°.78,
02/07/2025,09:39,,WDS24888,Backup 4G,1692,‡∏û‡∏∏‡∏ó‡∏ò‡∏°‡∏ì‡∏ë‡∏•‡∏™‡∏≤‡∏¢ 7,
02/07/2025,09:39,,WDS23264,Backup 4G,13044,‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏ô‡∏≤‡∏î‡∏µ (BW),
02/07/2025,09:39,,WDS37315,Backup 4G,16634,‡∏£‡∏û.‡∏™‡∏∏‡πÇ‡∏Ç‡∏ó‡∏±‡∏¢,
02/07/2025,09:39,,WDS24503,Backup 4G,1012,‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏ß‡∏±‡∏î‡∏û‡∏£‡∏∞‡∏ç‡∏≤‡∏ï‡∏¥,
02/07/2025,09:39,,WDS24840,Backup 4G,9864,‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å‡∏û‡∏•‡∏≤‡∏ã‡πà‡∏≤,
02/07/2025,09:39,,WDS23886,Backup 4G,10087,‡∏õ‡∏ï‡∏ó.‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å,
02/07/2025,13:40,,U93798,Main Link,13886,‡∏õ‡∏ï‡∏ó.‡∏´‡∏ô‡∏≠‡∏á‡∏ö‡∏±‡∏ß (NC),
02/07/2025,13:40,,V20672B,Main Link,12108,‡∏û‡∏∏‡∏ó‡∏ò‡∏°‡∏ì‡∏ë‡∏•‡∏™‡∏≤‡∏¢ 2 ‡∏ã‡∏≠‡∏¢ 2 (BW),
02/07/2025,13:40,,V94419B,Main Link,4312,‡∏ã‡∏≠‡∏¢‡∏ô‡∏ß‡∏•‡∏à‡∏¥‡∏ï‡∏£ ‡∏à‡∏∏‡∏î 2,
02/07/2025,13:40,,U87773,Main Link,4728,‡∏ô‡∏†‡∏≤‡∏à‡∏£‡∏±‡∏™,
02/07/2025,13:40,,U94145,Main Link,14222,PTTOR ‡∏î‡πà‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢ (NE),
02/07/2025,13:41,,WDS25449,Backup 4G,11801,‡∏õ‡∏ï‡∏ó.‡∏´‡∏ô‡∏≠‡∏á‡∏õ‡∏•‡∏¥‡∏á‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÄ‡∏û‡∏ä‡∏£ (RC),
02/07/2025,13:41,,WDS24834,Backup 4G,3225,‡∏ò‡∏£‡∏£‡∏°‡∏à‡∏±‡∏Å‡∏£,
02/07/2025,13:41,,WDS23719,Backup 4G,11833,Cargill Factory Market,
02/07/2025,13:41,,WDS25016,Backup 4G,10299,DC ‡∏°‡∏´‡∏≤‡∏ä‡∏±‡∏¢,
02/07/2025,13:41,,WDS23899,Backup 4G,10342,‡∏£‡∏≤‡∏ä‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô (‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÄ‡∏û‡∏ä‡∏£),
02/07/2025,13:41,,WDS24584,Backup 4G,1230,‡∏™‡∏±‡∏ô‡∏ï‡∏¥‡∏™‡∏∏‡∏Ç,
02/07/2025,13:41,,WDS24083,Backup 4G,3144,‡∏õ‡∏ï‡∏ó.‡∏´‡∏¥‡∏ô‡∏Å‡∏≠‡∏á,
02/07/2025,13:41,,WDS29821,Backup 4G,15621,PTTOR ‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏°‡∏û‡∏¥‡πÄ‡∏®‡∏© (RC)(‡∏õ‡∏ï‡∏ó.100%),
02/07/2025,13:41,,WDS25141,Backup 4G,5094,FR.‡∏ö‡πâ‡∏≤‡∏ô‡∏®‡∏£‡∏µ‡∏î‡∏≠‡∏ô‡πÑ‡∏ä‡∏¢ 1,
02/07/2025,13:41,,WDS35692,Backup 4G,16252,‡∏ï‡∏•‡∏≤‡∏î‡∏£‡∏∏‡πà‡∏á‡πÇ‡∏£‡∏à‡∏ô‡πå‡πÄ‡∏à‡∏£‡∏¥‡∏ç‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå,
03/07/2025,09:20,,V93168B,Main Link,992,‡∏ï‡∏•‡∏≤‡∏î‡∏™‡∏≥‡πÄ‡∏´‡∏£‡πà,
03/07/2025,09:20,,U66349,Main Link,15414,‡∏ò‡∏≤‡∏£‡∏≤‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏î‡πÄ‡∏ó‡∏• 3 (NE),
03/07/2025,09:20,,V92454B,Main Link,8572,‡∏£‡∏û.‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û(‡∏û‡∏•‡∏≤‡∏ã‡πà‡∏≤),
03/07/2025,09:20,,V20317B,Main Link,13419,GAYSORN OFFICE TOWER (BW),
03/07/2025,09:20,,V93258B,Main Link,338,‡∏ï‡∏•‡∏≤‡∏î‡∏û‡∏•‡∏π,
03/07/2025,09:20,,WDS27402,Backup 4G,5840,‡∏õ‡∏ï‡∏ó.‡∏ô‡πâ‡∏≥‡πÅ‡∏û‡∏£‡πà,
03/07/2025,09:20,,WDS27402,Backup 4G,17054,PTTOR ‡πÄ‡∏Ç‡∏≤‡∏ß‡∏±‡∏á (‡∏£‡∏≤‡∏ä‡∏ö‡∏∏‡∏£‡∏µ),
03/07/2025,09:20,,WDS32651,Backup 4G,16016,‡∏®‡∏£‡∏µ‡∏õ‡∏£‡∏∞‡∏à‡∏±‡∏ô‡∏ï‡πå,
03/07/2025,07:20,,WDS24700,Backup 4G,5000,‡∏ï‡∏≤‡∏Å‡∏û‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°,
03/07/2025,09:20,,WDS24280,Backup 4G,5583,‡∏ï‡∏•‡∏≤‡∏î‡∏õ‡∏•‡∏≤‡∏ä‡∏°‡∏†‡∏π‡∏û‡∏á‡∏®‡πå,
03/07/2025,09:20,,WDS24383,Backup 4G,7695,‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡πå,
03/07/2025,09:20,,WDS24762,Backup 4G,2159,‡∏ö‡∏Ç‡∏™.‡∏™‡∏¥‡∏á‡∏´‡πå‡∏ö‡∏∏‡∏£‡∏µ,
03/07/2025,09:20,,WDS25156,Backup 4G,6927,‡∏ã‡∏≠‡∏¢‡∏õ‡∏£‡∏∞‡∏ó‡∏≤‡∏ô‡∏û‡∏£,
03/07/2025,09:20,,WDS27391,Backup 4G,9307,‡∏ö‡πâ‡∏≤‡∏ô‡∏´‡∏ô‡∏≠‡∏á‡πÇ‡∏Ñ‡πâ‡∏á,
03/07/2025,09:20,,WDS25075,Backup 4G,4172,‡∏õ‡∏ï‡∏ó.‡∏ô‡∏Ñ‡∏£‡∏ä‡∏±‡∏¢‡∏®‡∏£‡∏µ,
03/07/2025,13:38,,V85681B,Main Link,6186,‡∏°.‡∏û‡∏§‡∏Å‡∏©‡∏≤‡∏ß‡∏¥‡∏•‡∏•‡πå 63-‡∏û‡∏£‡∏∞‡∏£‡∏≤‡∏° 5,
03/07/2025,13:38,,V20616B,Main Link,8145,‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏™‡∏°‡πÄ‡∏î‡πá‡∏à‡∏û‡∏£‡∏∞‡πÄ‡∏ó‡∏û‡∏£‡∏±‡∏ï‡∏ô‡πå(‡∏£.‡∏û.‡∏£‡∏≤‡∏°‡∏≤‡∏Ø),
03/07/2025,13:38,,U93625,Main Link,13428,‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ô‡∏¥‡∏Ñ‡∏°‡∏™‡∏≤‡∏¢ 4 (‡πÄ‡∏Ç‡∏≤‡∏™‡∏π‡∏á) (RC),
03/07/2025,13:38,,U98051,Main Link,16045,PTTOR ‡πÅ‡∏¢‡∏Å‡∏ö‡πâ‡∏≤‡∏ô‡∏ö‡∏∂‡∏á,
03/07/2025,13:38,,U52055,Main Link,17058,‡∏Ç‡∏ô‡∏á‡∏û‡∏£‡∏∞‡πÉ‡∏ï‡πâ,
03/07/2025,13:38,,WDS24778,Backup 4G,8358,‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏∏‡∏î‡∏£‡∏ó‡∏¥‡∏û‡∏¢‡πå,
03/07/2025,13:38,,WDS27097,Backup 4G,11174,‡∏ó‡πà‡∏≤‡πÑ‡∏°‡πâ,
03/07/2025,13:38,,WDS23808,Backup 4G,3804,‡∏õ‡∏ï‡∏ó‡∏´‡∏ô‡∏≠‡∏á‡∏ú‡∏∂‡πâ‡∏á,
03/07/2025,13:38,,WDS35689,Backup 4G,16267,‡∏≠‡∏á‡∏Ñ‡∏£‡∏±‡∏Å‡∏©‡πå ‡∏≠‡πà‡∏≤‡∏á‡∏ó‡∏≠‡∏á,
03/07/2025,13:38,,WDS37374,Backup 4G,16765,‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏à‡∏£‡∏¥‡∏ç‡∏™‡∏∏‡∏Ç(‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÅ‡∏™‡∏ô),
03/07/2025,13:38,,WDS24175,Backup 4G,544,‡∏£‡∏¥‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÅ‡∏Ñ‡∏ß,
03/07/2025,13:38,,WDS37425,Backup 4G,16774,PTTOR ‡πÄ‡∏Ç‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß (‡∏™‡∏¥‡∏á‡∏´‡∏ô‡∏Ñ‡∏£),
03/07/2025,13:38,,WDS37114,Backup 4G,16650,‡πÄ‡∏õ‡πÇ‡∏ï‡∏£-‡∏î‡∏á‡πÄ‡∏Å‡∏ï‡∏∏,
03/07/2025,13:38,,WDS38007,Backup 4G,17034,‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏≤‡∏†‡∏¥‡πÄ‡∏©‡∏Å ‡πÇ‡∏ã‡∏ô C,
03/07/2025,13:38,,WDS24653,Backup 4G,5072,‡∏û‡∏£‡∏∞‡∏≠‡∏á‡∏Ñ‡πå‡∏î‡∏≥(‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å),
04/07/2025,09:32,,U91345,Main Link,4673,‡∏≠‡∏î‡∏∏‡∏•‡∏¢‡∏≤‡∏£‡∏≤‡∏°,
04/07/2025,09:32,,V96591B,Main Link,11107,‡∏™‡∏∏‡∏Ç‡∏∏‡∏°‡∏ß‡∏¥‡∏ó 66 (BS),
04/07/2025,09:32,,V50228B,Main Link,11942,SV ‡∏û‡∏£‡∏∞‡∏£‡∏≤‡∏° 3,
04/07/2025,09:32,,U09111,Main Link,11470,‡∏Ñ‡∏•‡∏≠‡∏á‡∏ï‡∏≥‡∏´‡∏£‡∏∏ 5 (‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ),
04/07/2025,09:32,,U17767,Main Link,3648,‡∏ã‡∏≠‡∏¢‡∏ö‡∏≤‡∏î‡∏≤‡∏•,
04/07/2025,09:32,,WDS24645,Backup 4G,5566,‡∏õ‡∏ó‡∏∏‡∏°‡∏ó‡∏≠‡∏á 2,
04/07/2025,09:32,,WDS25172,Backup 4G,8629,‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏°‡∏´‡∏≤‡∏£‡∏≤‡∏ä (‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà),
04/07/2025,09:32,,WDS27376,Backup 4G,11399,‡πÅ‡∏¢‡∏Å‡∏™‡∏ô‡∏≤‡∏°‡∏ö‡∏¥‡∏ô2,
04/07/2025,09:32,,WDS27387,Backup 4G,13952,FR.‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏£‡∏≤‡∏ä‡πÄ‡∏ß‡∏ä (‡∏à.‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà),
04/07/2025,09:32,,WDS37320,Backup 4G,16751,‡∏™‡∏≤‡∏°‡∏û‡∏£‡∏≤‡∏ô ‡∏ã‡∏≠‡∏¢ 2,
04/07/2025,09:32,,WDS23563,Backup 4G,9528,‡πÅ‡∏°‡πà‡∏ó‡∏∞,
04/07/2025,09:32,,WDS24363,Backup 4G,7016,‡∏õ‡∏ï‡∏ó.‡∏ö‡∏≤‡∏á‡∏™‡∏∞‡∏û‡∏≤‡∏ô,
04/07/2025,09:32,,WDS24854,Backup 4G,2838,‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏ó‡πà‡∏≤‡∏®‡∏≤‡∏•‡∏≤,
04/07/2025,09:32,,WDS23531,Backup 4G,8083,‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏™‡∏≤‡∏£‡∏†‡∏µ,
04/07/2025,09:32,,WDS23742,Backup 4G,11954,‡∏ï‡∏•‡∏≤‡∏î‡∏Ñ‡∏•‡∏±‡∏á‡∏°‡∏≤‡∏£‡πå‡πÄ‡∏ä‡πà,
`;

        // Function to parse CSV string into an array of objects
        function parseCsv(csvString) {
            const lines = csvString.trim().split('\n');
            const headers = lines[0].split(',').map(header => header.trim());
            const data = [];

            for (let i = 1; i < lines.length; i++) {
                const values = lines[i].split(',');
                const row = {};
                headers.forEach((header, index) => {
                    row[header] = values[index] ? values[index].trim() : '';
                });
                data.push(row);
            }
            return data;
        }

        // Process the raw CSV data
        const parsedCsvData = parseCsv(rawCsvData);
        let currentlyDisplayedData = []; // This will hold individual rows after all filters are applied

        // Calculate duplicate store IDs once from the full dataset (for the "(‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πâ‡∏≥)" tag)
        const storeIdCountsAllData = new Map();
        parsedCsvData.forEach(row => {
            storeIdCountsAllData.set(row['Store ID'], (storeIdCountsAllData.get(row['Store ID']) || 0) + 1);
        });
        const duplicateStoreIdsAllData = new Set();
        for (const [storeId, count] of storeIdCountsAllData.entries()) {
            if (count > 1) {
                duplicateStoreIdsAllData.add(storeId);
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            // Set default date range to cover all data
            const dates = parsedCsvData.map(row => new Date(row.Date.split('/').reverse().join('-')));
            const minDate = new Date(Math.min(...dates));
            const maxDate = new Date(Math.max(...dates));

            document.getElementById('startDate').valueAsDate = minDate;
            document.getElementById('endDate').valueAsDate = maxDate;

            // Populate Province and Region filters
            populateLocationFilters();

            initializeDashboard();

            document.getElementById('applyFilterBtn').addEventListener('click', updateDashboard);
            document.getElementById('searchInput').addEventListener('input', updateDashboard);
            document.getElementById('trueCidFilterInput').addEventListener('input', updateDashboard); // New event listener for True CID filter
            document.getElementById('problemTypeFilter').addEventListener('change', updateDashboard);
            document.getElementById('ticketStatusFilter').addEventListener('change', updateDashboard);
            document.getElementById('remarkStatusFilter').addEventListener('change', updateDashboard);
            document.getElementById('provinceFilter').addEventListener('change', updateDashboard);
            document.getElementById('regionFilter').addEventListener('change', updateDashboard);
            document.getElementById('downloadCsvBtn').addEventListener('click', downloadCsv);

            // Modal event listeners
            const duplicateStoresCard = document.getElementById('duplicate-stores-card');
            if (duplicateStoresCard) {
                duplicateStoresCard.addEventListener('click', showDuplicateStoresModal);
            }
            document.querySelector('#duplicateStoresModal .close-button').addEventListener('click', () => {
                document.getElementById('duplicateStoresModal').style.display = 'none';
            });
            window.addEventListener('click', (event) => {
                if (event.target === document.getElementById('duplicateStoresModal')) {
                    document.getElementById('duplicateStoresModal').style.display = 'none';
                }
            });

            // Affected Provinces Modal
            const affectedProvincesCard = document.getElementById('total-affected-provinces-card');
            if (affectedProvincesCard) {
                affectedProvincesCard.addEventListener('click', showAffectedProvincesModal);
            }
            document.querySelector('#affectedProvincesModal .close-button').addEventListener('click', () => {
                document.getElementById('affectedProvincesModal').style.display = 'none';
            });
            window.addEventListener('click', (event) => {
                if (event.target === document.getElementById('affectedProvincesModal')) {
                    document.getElementById('affectedProvincesModal').style.display = 'none';
                }
            });

            // Affected Regions Modal
            const affectedRegionsCard = document.getElementById('total-affected-regions-card');
            if (affectedRegionsCard) {
                affectedRegionsCard.addEventListener('click', showAffectedRegionsModal);
            }
            document.querySelector('#affectedRegionsModal .close-button').addEventListener('click', () => {
                document.getElementById('affectedRegionsModal').style.display = 'none';
            });
            window.addEventListener('click', (event) => {
                if (event.target === document.getElementById('affectedRegionsModal')) {
                    document.getElementById('affectedRegionsModal').style.display = 'none';
                }
            });
        });

        // Add Province and Region to parsedCsvData
        parsedCsvData.forEach(row => {
            const locationInfo = storeLocations[row['Store ID']];
            if (locationInfo) {
                row.Province = locationInfo.province;
                row.Region = locationInfo.region;
            } else {
                row.Province = '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î';
                row.Region = '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏†‡∏≤‡∏Ñ';
            }
        });

        function populateLocationFilters() {
            const provinceFilter = document.getElementById('provinceFilter');
            const regionFilter = document.getElementById('regionFilter');

            const uniqueProvinces = new Set();
            const uniqueRegions = new Set();

            parsedCsvData.forEach(row => {
                if (row.Province && row.Province !== '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î') {
                    uniqueProvinces.add(row.Province);
                }
                if (row.Region && row.Region !== '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏†‡∏≤‡∏Ñ') {
                    uniqueRegions.add(row.Region);
                }
            });

            // Populate Province Filter
            Array.from(uniqueProvinces).sort().forEach(province => {
                const option = document.createElement('option');
                option.value = province;
                option.textContent = province;
                provinceFilter.appendChild(option);
            });

            // Populate Region Filter
            Array.from(uniqueRegions).sort().forEach(region => {
                const option = document.createElement('option');
                option.value = region;
                option.textContent = region;
                regionFilter.appendChild(option);
            });
        }


        function initializeDashboard() {
            updateDashboard(); // Initial load
        }

        function updateDashboard() {
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const trueCidFilterTerm = document.getElementById('trueCidFilterInput').value.toLowerCase(); // Get True CID filter term
            const problemTypeFilter = document.getElementById('problemTypeFilter').value;
            const ticketStatusFilter = document.getElementById('ticketStatusFilter').value;
            const remarkStatusFilter = document.getElementById('remarkStatusFilter').value;
            const provinceFilter = document.getElementById('provinceFilter').value;
            const regionFilter = document.getElementById('regionFilter').value;


            // Filter parsedCsvData based on ALL filters
            currentlyDisplayedData = parsedCsvData.filter(row => {
                const rowDate = new Date(row.Date.split('/').reverse().join('-'));
                const start = new Date(startDate);
                const end = new Date(endDate);

                const matchesDate = rowDate >= start && rowDate <= end;

                const matchesSearch = row['Store Name'].toLowerCase().includes(searchTerm) ||
                                      row['Store ID'].includes(searchTerm) ||
                                      row.Ticket.toLowerCase().includes(searchTerm) ||
                                      row.Remark.toLowerCase().includes(searchTerm); // Removed True CID from general search to avoid redundancy

                const matchesTrueCid = trueCidFilterTerm === '' || row['True CID'].toLowerCase().includes(trueCidFilterTerm); // New True CID filter

                const matchesProblemType = problemTypeFilter === '' || row['Problem Type'] === problemTypeFilter;

                const matchesTicketStatus = ticketStatusFilter === '' || 
                                            (ticketStatusFilter === 'hasTicket' && row.Ticket !== '') ||
                                            (ticketStatusFilter === 'noTicket' && row.Ticket === '');

                const matchesRemarkStatus = remarkStatusFilter === '' ||
                                            (remarkStatusFilter === 'hasRemark' && row.Remark !== '') ||
                                            (remarkStatusFilter === 'noRemark' && row.Remark === '');

                const matchesProvince = provinceFilter === '' || row.Province === provinceFilter;
                const matchesRegion = regionFilter === '' || row.Region === regionFilter;

                return matchesDate && matchesSearch && matchesTrueCid && matchesProblemType && matchesTicketStatus && matchesRemarkStatus && matchesProvince && matchesRegion;
            });

            // Re-render all sections with the filtered data
            renderKeyMetrics(currentlyDisplayedData);
            createDailyIncidentsChart(currentlyDisplayedData);
            createProblemTypeChart(currentlyDisplayedData);
            renderDetailsLists(currentlyDisplayedData); // Pass the fully filtered data to details list
        }


        function renderKeyMetrics(data) { // 'data' is currentlyDisplayedData (individual rows)
            // Calculate total unique incidents from the filtered data
            const uniqueIncidents = new Set();
            data.forEach(row => {
                const [day, month, year] = row.Date.split('/');
                const formattedDate = `${year}-${month}-${day}`;
                uniqueIncidents.add(`${formattedDate}-${row.Time}-${row['Problem Type']}`);
            });
            const totalIncidents = uniqueIncidents.size;

            // Calculate total unique affected stores across all incidents within the filtered data
            const allAffectedStoreIds = new Set();
            data.forEach(row => {
                allAffectedStoreIds.add(row['Store ID']);
            });
            const totalAffectedStores = allAffectedStoreIds.size;

            // Calculate unique tickets from filtered data
            const uniqueTickets = new Set();
            data.forEach(row => {
                if (row.Ticket) {
                    uniqueTickets.add(row.Ticket);
                }
            });

            // Calculate unique True CIDs for Main Link and Backup 4G from filtered data
            const uniqueTrueCidsMainLink = new Set();
            const uniqueTrueCidsBackup4G = new Set();
            data.forEach(row => {
                if (row['True CID']) {
                    if (row['Problem Type'] === 'Main Link') {
                        uniqueTrueCidsMainLink.add(row['True CID']);
                    } else if (row['Problem Type'] === 'Backup 4G') {
                        uniqueTrueCidsBackup4G.add(row['True CID']);
                    }
                }
            });

            // Calculate duplicate store IDs (stores that appear more than once in the *filtered* raw data)
            const storeIdCountsFiltered = new Map();
            data.forEach(row => {
                storeIdCountsFiltered.set(row['Store ID'], (storeIdCountsFiltered.get(row['Store ID']) || 0) + 1);
            });
            let duplicateReportedStoreCount = 0;
            for (const [storeId, count] of storeIdCountsFiltered.entries()) {
                if (count > 1) {
                    duplicateReportedStoreCount++;
                }
            }

            // Calculate unique affected provinces
            const affectedProvinces = new Set();
            data.forEach(row => {
                if (row.Province && row.Province !== '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î') {
                    affectedProvinces.add(row.Province);
                }
            });

            // Calculate unique affected regions
            const affectedRegions = new Set();
            data.forEach(row => {
                if (row.Region && row.Region !== '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏†‡∏≤‡∏Ñ') {
                    affectedRegions.add(row.Region);
                }
            });
            
            document.getElementById('total-incidents').textContent = totalIncidents;
            document.getElementById('total-affected-stores').textContent = totalAffectedStores;
            document.getElementById('total-tickets').textContent = uniqueTickets.size;
            document.getElementById('total-true-cids-main-link').textContent = uniqueTrueCidsMainLink.size;
            document.getElementById('total-true-cids-backup-4g').textContent = uniqueTrueCidsBackup4G.size;
            document.getElementById('total-duplicate-stores').textContent = duplicateReportedStoreCount;
            document.getElementById('total-affected-provinces').textContent = affectedProvinces.size;
            document.getElementById('total-affected-regions').textContent = affectedRegions.size;
        }

        function createDailyIncidentsChart(data) { // 'data' is currentlyDisplayedData (individual rows)
            const ctx = document.getElementById('dailyIncidentsChart').getContext('2d');
            
            if (window.dailyIncidentsChartInstance) {
                window.dailyIncidentsChartInstance.destroy();
            }

            const dailyCounts = new Map(); // Key: date, Value: { Main Link: count, Backup 4G: count }
            data.forEach(row => {
                const [day, month, year] = row.Date.split('/');
                const formattedDate = `${year}-${month}-${day}`;
                if (!dailyCounts.has(formattedDate)) {
                    dailyCounts.set(formattedDate, { 'Main Link': 0, 'Backup 4G': 0 });
                }
                dailyCounts.get(formattedDate)[row['Problem Type']]++;
            });

            const labels = Array.from(dailyCounts.keys()).sort();
            const mainLinkData = labels.map(label => dailyCounts.get(label)['Main Link']);
            const backup4gData = labels.map(label => dailyCounts.get(label)['Backup 4G']);

            window.dailyIncidentsChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels.map(l => new Date(l).toLocaleDateString('th-TH', { day: 'numeric', month: 'short' })),
                    datasets: [
                        { label: 'Main Link', data: mainLinkData, backgroundColor: 'rgb(59 130 246)', },
                        { label: 'Backup 4G', data: backup4gData, backgroundColor: 'rgb(217 119 6)', }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: { stacked: true },
                        y: { stacked: true, beginAtZero: true, ticks: { stepSize: 1 } }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                title: (tooltipItems) => `‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${tooltipItems[0].label}`,
                                label: (context) => {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    label += context.raw + ' ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤'; // Now counts stores, not incidents
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        }

        function createProblemTypeChart(data) { // 'data' is currentlyDisplayedData (individual rows)
            const ctx = document.getElementById('problemTypeChart').getContext('2d');

            if (window.problemTypeChartInstance) {
                window.problemTypeChartInstance.destroy();
            }

            const mainLinkStoresCount = data.filter(row => row['Problem Type'] === 'Main Link').length;
            const backup4gStoresCount = data.filter(row => row['Problem Type'] === 'Backup 4G').length;

            window.problemTypeChartInstance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Main Link', 'Backup 4G'],
                    datasets: [{
                        label: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤',
                        data: [mainLinkStoresCount, backup4gStoresCount],
                        backgroundColor: ['rgb(59 130 246)', 'rgb(217 119 6)'],
                        borderColor: ['#fff'],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' },
                        tooltip: {
                            callbacks: {
                                label: (context) => ` ${context.label}: ${context.raw} ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤`
                            }
                        }
                    }
                }
            });
        }
        
        function renderDetailsLists(dataToDisplay) { // 'dataToDisplay' is currentlyDisplayedData (individual rows)
            const mainLinkList = document.getElementById('main-link-list');
            const backup4gList = document.getElementById('backup-4g-list');
            mainLinkList.innerHTML = '';
            backup4gList.innerHTML = '';
            
            let foundResults = false;

            // Re-group dataToDisplay into incidents for rendering
            const groupedFilteredIncidents = new Map();
            dataToDisplay.forEach(row => {
                const [day, month, year] = row.Date.split('/');
                const formattedDate = `${year}-${month}-${day}`;
                const key = `${formattedDate}-${row.Time}-${row['Problem Type']}`;

                if (!groupedFilteredIncidents.has(key)) {
                    groupedFilteredIncidents.set(key, {
                        date: formattedDate,
                        time: row.Time,
                        type: row['Problem Type'],
                        stores: []
                    });
                }
                const incident = groupedFilteredIncidents.get(key);
                incident.stores.push({
                    id: row['Store ID'],
                    name: row['Store Name'],
                    ticket: row.Ticket,
                    trueCid: row['True CID'],
                    remark: row.Remark,
                    province: row.Province, // Add province
                    region: row.Region // Add region
                });
            });

            const sortedGroupedIncidents = Array.from(groupedFilteredIncidents.values()).sort((a, b) => {
                const dateA = new Date(`${a.date}T${a.time}:00`);
                const dateB = new Date(`${b.date}T${b.time}:00`);
                return dateA - dateB;
            });

            if (sortedGroupedIncidents.length === 0) {
                document.getElementById('no-results').style.display = 'block';
                return;
            } else {
                document.getElementById('no-results').style.display = 'none';
            }

            sortedGroupedIncidents.forEach(incident => {
                foundResults = true; // At least one incident found

                const card = document.createElement('div');
                card.className = 'p-4 rounded-lg border bg-slate-50';
                
                const storeListHtml = incident.stores.map(store => `
                    <li class="flex flex-col sm:flex-row sm:justify-between items-start sm:items-center text-sm py-1 border-b border-slate-200 last:border-b-0">
                        <div class="flex-grow">
                            <span class="text-slate-700 font-medium">‡∏£‡∏´‡∏±‡∏™‡∏™‡∏≤‡∏Ç‡∏≤ ${store.id} ‡∏™‡∏≤‡∏Ç‡∏≤ ${store.name} ${duplicateStoreIdsAllData.has(store.id) ? '<span class="text-xs text-orange-500">(‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πâ‡∏≥)</span>' : ''}</span>
                            ${store.province !== '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î' ? `<p class="text-xs text-slate-500 mt-1 sm:mt-0">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î: ${store.province} (${store.region})</p>` : ''}
                            ${store.ticket ? `<p class="text-xs text-slate-500 mt-1 sm:mt-0">Ticket: ${store.ticket}</p>` : ''}
                            ${store.trueCid ? `<p class="text-xs text-slate-500 mt-1 sm:mt-0">True CID: ${store.trueCid}</p>` : ''}
                            ${store.remark ? `<p class="text-xs text-slate-500 mt-1 sm:mt-0">Remark: ${store.remark}</p>` : ''}
                        </div>
                    </li>
                `).join('');

                card.innerHTML = `
                    <div class="flex justify-between items-center mb-2">
                        <p class="text-sm font-semibold text-slate-600">${new Date(incident.date).toLocaleDateString('th-TH', { year: 'numeric', month: 'long', day: 'numeric' })}</p>
                        <p class="text-sm text-slate-500">${incident.time} ‡∏ô.</p>
                    </div>
                    <ul class="space-y-1">${storeListHtml}</ul>
                `;

                if (incident.type === 'Main Link') {
                    card.classList.add('border-blue-200');
                    mainLinkList.appendChild(card);
                } else {
                    card.classList.add('border-amber-200');
                    backup4gList.appendChild(card);
                }
            });
            
            document.getElementById('no-results').style.display = foundResults ? 'none' : 'block';
        }
        
        // This function is now just a wrapper to trigger updateDashboard
        function filterLists(searchTerm) {
             updateDashboard();
        }

        function downloadCsv() {
            let csvContent = "data:text/csv;charset=utf-8,\uFEFF"; // Add BOM for Thai characters
            csvContent += "Date,Time,Problem Type,Store ID,Store Name,Ticket,True CID,Remark,Province,Region\n"; // Updated headers

            currentlyDisplayedData.forEach(row => { // Use currentlyDisplayedData for direct CSV output
                const rowValues = [
                    row.Date,
                    row.Time,
                    row['Problem Type'],
                    row['Store ID'],
                    `"${row['Store Name'].replace(/"/g, '""')}"`, // Handle commas and quotes
                    `"${row.Ticket.replace(/"/g, '""')}"`,
                    `"${row['True CID'].replace(/"/g, '""')}"`,
                    `"${row.Remark.replace(/"/g, '""')}"`,
                    `"${row.Province.replace(/"/g, '""')}"`,
                    `"${row.Region.replace(/"/g, '""')}"`
                ];
                csvContent += rowValues.join(',') + "\n";
            });

            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "router_incident_report_filtered.csv"); // Changed filename
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function showDuplicateStoresModal() {
            const modal = document.getElementById('duplicateStoresModal');
            const list = document.getElementById('duplicate-stores-list');
            list.innerHTML = ''; // Clear previous list

            const duplicateStoresDetails = new Map(); // Store ID -> {name, count}

            // Iterate through the original parsedCsvData to get full counts
            parsedCsvData.forEach(row => {
                if (duplicateStoreIdsAllData.has(row['Store ID'])) {
                    if (!duplicateStoresDetails.has(row['Store ID'])) {
                        duplicateStoresDetails.set(row['Store ID'], { name: row['Store Name'], count: 0, problemTypes: new Set(), province: row.Province, region: row.Region });
                    }
                    const detail = duplicateStoresDetails.get(row['Store ID']);
                    detail.count++;
                    detail.problemTypes.add(row['Problem Type']);
                }
            });

            // Sort by count (descending) then by store name
            const sortedDuplicateStores = Array.from(duplicateStoresDetails.entries()).sort((a, b) => {
                if (b[1].count !== a[1].count) {
                    return b[1].count - a[1].count;
                }
                return a[1].name.localeCompare(b[1].name, 'th', { sensitivity: 'base' });
            });

            if (sortedDuplicateStores.length === 0) {
                list.innerHTML = '<li class="text-slate-500">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏≤‡∏Ç‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</li>';
            } else {
                sortedDuplicateStores.forEach(([id, details]) => {
                    const listItem = document.createElement('li');
                    listItem.className = 'p-3 bg-slate-100 rounded-lg border border-slate-200 flex flex-col sm:flex-row sm:justify-between items-start sm:items-center';
                    listItem.innerHTML = `
                        <div class="flex-grow">
                            <span class="font-semibold text-slate-800">‡∏£‡∏´‡∏±‡∏™‡∏™‡∏≤‡∏Ç‡∏≤ ${id} ‡∏™‡∏≤‡∏Ç‡∏≤ ${details.name}</span>
                            ${details.province !== '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î' ? `<p class="text-xs text-slate-500 mt-1 sm:mt-0">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î: ${details.province} (${details.region})</p>` : ''}
                            <p class="text-xs text-slate-500 mt-1 sm:mt-0">‡πÅ‡∏à‡πâ‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤ ${details.count} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</p>
                            <p class="text-xs text-slate-500">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏õ‡∏±‡∏ç‡∏´‡∏≤: ${Array.from(details.problemTypes).join(', ')}</p>
                        </div>
                    `;
                    list.appendChild(listItem);
                });
            }

            modal.style.display = 'flex'; // Use flex to center content
        }

        function showAffectedProvincesModal() {
            const modal = document.getElementById('affectedProvincesModal');
            const list = document.getElementById('affected-provinces-list');
            list.innerHTML = '';

            const affectedProvincesMap = new Map(); // Province -> count of stores

            currentlyDisplayedData.forEach(row => {
                if (row.Province && row.Province !== '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î') {
                    affectedProvincesMap.set(row.Province, (affectedProvincesMap.get(row.Province) || 0) + 1);
                }
            });

            const sortedProvinces = Array.from(affectedProvincesMap.entries()).sort((a, b) => {
                if (b[1] !== a[1]) {
                    return b[1] - a[1]; // Sort by count descending
                }
                return a[0].localeCompare(b[0], 'th', { sensitivity: 'base' }); // Then by province name
            });

            if (sortedProvinces.length === 0) {
                list.innerHTML = '<li class="text-slate-500">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏á</li>';
            } else {
                sortedProvinces.forEach(([province, count]) => {
                    const listItem = document.createElement('li');
                    listItem.className = 'p-3 bg-slate-100 rounded-lg border border-slate-200 flex justify-between items-center';
                    listItem.innerHTML = `
                        <span class="font-semibold text-slate-800">${province}</span>
                        <span class="text-sm text-slate-600">${count} ‡∏™‡∏≤‡∏Ç‡∏≤</span>
                    `;
                    list.appendChild(listItem);
                });
            }
            modal.style.display = 'flex';
        }

        function showAffectedRegionsModal() {
            const modal = document.getElementById('affectedRegionsModal');
            const list = document.getElementById('affected-regions-list');
            list.innerHTML = '';

            const affectedRegionsMap = new Map(); // Region -> count of stores

            currentlyDisplayedData.forEach(row => {
                if (row.Region && row.Region !== '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏†‡∏≤‡∏Ñ') {
                    affectedRegionsMap.set(row.Region, (affectedRegionsMap.get(row.Region) || 0) + 1);
                }
            });

            const sortedRegions = Array.from(affectedRegionsMap.entries()).sort((a, b) => {
                if (b[1] !== a[1]) {
                    return b[1] - a[1]; // Sort by count descending
                }
                return a[0].localeCompare(b[0], 'th', { sensitivity: 'base' }); // Then by region name
            });

            if (sortedRegions.length === 0) {
                list.innerHTML = '<li class="text-slate-500">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏†‡∏≤‡∏Ñ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏á</li>';
            } else {
                sortedRegions.forEach(([region, count]) => {
                    const listItem = document.createElement('li');
                    listItem.className = 'p-3 bg-slate-100 rounded-lg border border-slate-200 flex justify-between items-center';
                    listItem.innerHTML = `
                        <span class="font-semibold text-slate-800">${region}</span>
                        <span class="text-sm text-slate-600">${count} ‡∏™‡∏≤‡∏Ç‡∏≤</span>
                    `;
                    list.appendChild(listItem);
                });
            }
            modal.style.display = 'flex';
        }

    </script>
</body>
</html>
